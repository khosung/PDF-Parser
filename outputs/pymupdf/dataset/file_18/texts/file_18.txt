암호모듈
구현안내서
Guide for
Vendor Implementations
GVI Part 2
(‘25. 10.)
Part 2
검증대상 암호알고리즘 구현안내서

GVI
Part 2
Guide for 
Vendor 
 Implementations

Contents
1장 개요
2
 
2장 블록암호 운영모드(일반)
12
 
3장 블록암호 운영모드(인증암호화)
28
 
4장 블록암호 기반 메시지인증코드
42
 
5장 해시함수 기반 메시지인증코드
54
 
6장 블록암호 기반 난수발생기
60
 
7장 해시함수 기반 난수발생기
80
 
8장 RSA 기반 공개키 암호
100
 
9장 RSA 기반 전자서명
112
 
10장 이산대수 기반 전자서명
124
 
11장 타원곡선 기반 전자서명
136
 
12장 이산대수 기반 키 설정
152
 
13장 타원곡선 기반 키 설정
160
 
14장 패스워드 기반 키 유도
168
 
15장 의사난수 함수 기반 키 유도
174
 
부록
186

GVI
Part 2
Guide for 
Vendor 
 Implementations

1장 개요

암호모듈 구현안내서
2
목적
▸암호모듈 검증제도는 국가·공공기관에서 소통‧저장되는 비밀이 아닌 업무자료를 보호하기 위해사용되는 암호모듈의
안전성과 구현 적합성을 검증하는 제도이다.
▸안내서에서는｢암호알고리즘검증기준｣에수록된검증대상암호알고리즘의요구사항에대하여구현안전성관점에서
고려사항을 명세한다.
▸안내서는암호모듈검증제도의검증대상암호알고리즘별로안전성에영향을미치는항목을제공함으로써,암호모듈에
대한 잠재적인 취약점에 대응할 수 있도록 한다.
범위
▸안내서에서 다루는 알고리즘별 검토항목은 암호모듈 검증기준과 시험기준에서 요구하는 보안요구사항(키 관리,
파라미터 형식검증, 예외 처리 등)을 검증대상 암호알고리즘에 적용하여 도출하였다.
▸안내서 내용은 표준 일치성 여부 확인과 암호알고리즘에 대한 보안요구사항 준수여부 확인으로 구성된다.
▸안내서의알고리즘별약어및기호는참조표준을준수하였으며,알고리즘참조구현값은해당표준을참고해야한다.
활용대상 및 방법
▸안내서는 암호모듈 개발자와 암호모듈 시험자가 활용할 수 있다.
▸암호모듈개발자는암호모듈개발시,안내서를참고하여암호알고리즘구현안전성요소를파악하여적합하게
적용할 수 있다.
▸암호모듈 시험자는 암호모듈에 포함된 검증대상 암호알고리즘에 대한 구현 안전성 요소를 확인할 수 있다.
법적 근거
▸「사이버안보 업무규정」 제9조(사이버보안 예방 조치 등)
▸「전자정부법 시행령」 제69조(전자문서의 보관･유통 관련 보안조치)
▸「암호모듈 시험 및 검증지침」 (국가정보원, 2025)
개 요
1
2
3
4

Part2: 검증대상 암호알고리즘 구현안내서
3
검증대상 암호알고리즘 목록
q 다음은 검증기관이 선정한 검증대상 암호알고리즘 목록이다.
구 분
암호알고리즘
참조표준
블록암호
ARIA
운영모드
 ·기밀성(ECB, CBC, OFB,
CFB, CTR)
 ·기밀성/인증(GCM, CCM)
국내
[KS X 1213-1] 128비트 블록 암호 알고리즘 ARIA ­ 제1부: 일반 (2024)
[KS X 1213-2] 128비트 블록 암호 알고리즘 ARIA ­ 제2부: 운영모드(2024)
[KS X ISO/IEC 10116] n비트 블록 암호 운영 모드 (2021)
[KS X ISO/IEC 19772] 인증된 암호화 (2024)
국외
[IETF RFC 5794] A Description of the ARIA Encryption Algorithm (2010)
[ISO/IEC 10116] Modes of operation for an n-bit block cipher (2017)
[ISO/IEC 19772] Authenticated Encryption (2020)
SEED
운영모드
 ·기밀성(ECB, CBC, OFB,
CFB, CTR)
 ·기밀성/인증(GCM, CCM)
국내
[KS X ISO/IEC 18033-3] 암호 알고리즘 ­ 제3부: 블록 암호 (2023)
[TTAS.KO-12.0004/R1] 128비트 블록암호알고리즘 SEED (2005)
[KS X ISO/IEC 10116] n비트 블록 암호 운영 모드 (2021)
[KS X ISO/IEC 19772] 인증된 암호화 (2024)
국외
[ISO/IEC 18033-3] Encryption algorithms Part 3: Block ciphers (2010)
[ISO/IEC 10116] Modes of operation for an n-bit block cipher (2017)
[ISO/IEC 19772] Authenticated Encryption (2020)
LEA
운영모드
 ·기밀성(ECB, CBC, OFB,
CFB, CTR)
 ·기밀성/인증(GCM, CCM)
국내
[KS X ISO/IEC 29192-2] 경량 암호 ­ 제2부: 블록 암호 (2024)
[KS X ISO/IEC 10116] n비트 블록 암호 운영 모드 (2021)
[KS X ISO/IEC 19772] 인증된 암호화 (2024)
국외
[ISO/IEC 29192-2] Lightweight cryptography Part 2: Block ciphers (2019)
[ISO/IEC 10116] Modes of operation for an n-bit block cipher (2017)
[ISO/IEC 19772] Authenticated Encryption (2020)
HIGHT
운영모드
 ·기밀성(ECB, CBC, OFB,
CFB, CTR)
국내
[KS X ISO/IEC 18033-3] 암호 알고리즘 ­ 제3부: 블록 암호 (2023)
[TTAS.KO-12.0040/R1] 64비트 블록암호 HIGHT (2008)
[KS X ISO/IEC 10116] n비트 블록 암호 운영모드 (2021)
국외
[ISO/IEC 18033-3] Encryption algorithms Part 3: Block ciphers (2010)
[ISO/IEC 10116] Modes of operation for an n-bit block cipher (2017)
AES
운영모드
 ·기밀성(ECB, CBC, OFB,
CFB, CTR)
 ·기밀성/인증(GCM, CCM)
국내
[KS X ISO/IEC 18033-3] 암호 알고리즘 ­ 제3부: 블록 암호 (2023)
[KS X ISO/IEC 10116] n비트 블록 암호 운영 모드 (2021)
[KS X ISO/IEC 19772] 인증된 암호화 (2024)
국외
[ISO/IEC 18033-3] Encryption algorithms Part 3: Block ciphers (2010)
[ISO/IEC 10116] Modes of operation for an n-bit block cipher (2017)
[ISO/IEC 19772] Authenticated Encryption (2020)
해시함수
SHA-2
SHA2-224/256/384/512
국내
[KS X ISO/IEC 10118-3] 해시함수 ­ 제3부: 전용 해시 함수 (2023)
국외
[ISO/IEC 10118-3] Hash-functions Part 3: Dedicated hash-functions (2018)
LSH
LSH-224/256/384/512/
512-224/512-256
국내
[KS X 3262] 해시 함수 LSH (2023)
SHA-3
SHA3-224/256/384/512
국내
-
국외
[ISO/IEC 10118-3] Hash-functions Part 3: Dedicated hash-functions (2018)
5

암호모듈 구현안내서
4
구 분
암호알고리즘
참조표준
메시지
인증
해시함수
기반
HMAC
국내
[KS X ISO/IEC 9797-2] 메시지 인증 코드 ­ 제2부: 전용 해시 함수를 이용한
메커니즘 (2024)
[TTAK.KO-12.0330-Part1] 해시 함수 기반 메시지 인증 코드 (HMAC)
- 제1부: 일반 (2018)
[TTAK.KO-12.0330-Part2] 해시 함수 기반 메시지 인증 코드 (HMAC)
- 제2부: 해시 함수 SHA-2 (2018)
[TTAK.KO-12.0330-Part3] 해시 함수 기반 메시지 인증 코드 (HMAC)
- 제3부: 해시 함수 LSH (2018)
[TTAK.KO-12.0330-Part4] 해시 함수 기반 메시지 인증 코드 (HMAC)
- 제4부: 해시 함수 SHA-3 (2019)
국외
[ISO/IEC 9797-2] Message authentication codes (MACs) Part 2:
Mechanisms using a dedicated hash-function (2021)
블록암호
기반
CMAC, GMAC
국내
[KS X ISO/IEC 9797-1] 메시지 인증 코드 ­ 제1부: 블록 암호를 이용한
메커니즘 (2023)
[KS X ISO/IEC 9797-3] 메시지 인증 코드 ­ 제3부: 유니버셜 해시 함수를
사용하는 메커니즘 (2024)
[KS X ISO/IEC 19772] 인증된 암호화 (2024)
국외
[ISO/IEC 9797-1] Message Authentication Codes (MACs) - Part 1:
Mechanisms using a block cipher (2011)
[ISO/IEC 9797-3] Message Authentication Codes (MACs) - Part 3:
Mechanisms using a universal hash-function (2011)
[ISO/IEC 19772] Authenticated Encryption (2020)
난수발생기
해시함수
기반
Hash-DRBG
HMAC-DRBG
국내
[KS X ISO/IEC 18031] 난수발생기 (2023)
[TTAK.KO-12.0331-Part1/R1] 해시 함수 기반 결정론적 난수발생기 ­
제1부: 일반 (2022)
[TTAK.KO-12.0331-Part2] 해시 함수 기반 결정론적 난수발생기 ­
제2부: 해시 함수 SHA-2 (2018)
[TTAK.KO-12.0331-Part3] 해시 함수 기반 결정론적 난수발생기 ­
제3부: 해시 함수 LSH (2018)
[TTAK.KO-12.0331-Part4] 해시 함수 기반 결정론적 난수발생기 ­
제4부: 해시 함수 SHA-3 (2019)
[TTAK.KO-12.0332-Part1/R1] HMAC 기반 결정론적 난수발생기 ­
제1부: 일반 (2022)
[TTAK.KO-12.0332-Part2] HMAC 기반 결정론적 난수발생기 ­
제2부: 해시 함수 SHA-2 (2018)
[TTAK.KO-12.0332-Part3] HMAC 기반 결정론적 난수발생기 ­
제3부: 해시 함수 LSH (2018)
[TTAK.KO-12.0332-Part4] HMAC 기반 결정론적 난수발생기 ­
제4부: 해시 함수 SHA-3 (2019)
국외
[ISO/IEC 18031] Random bit generation (2025)
블록암호
기반
CTR-DRBG
국내
[KS X ISO/IEC 18031] 난수발생기 (2023)
[TTAK.KO-12.0189/R2] 블록 암호 기반 결정론적 난수발생기 (2022)
국외
[ISO/IEC 18031] Random bit generation (2025)
공개키
암호
RSAES
공개키 길이: 2048, 3072
해시함수: SHA2-224/256
국내
[KS X ISO/IEC 18033-2] 암호 알고리즘 ­ 제2부: 비대칭형 암호 (2022)
국외
[ISO/IEC 18033-2] Encryption algorithms Part 2: Asymmetric ciphers (2017)
[IETF RFC8017] PKCS#1:RSA CryptographySpecificationsVersion2.2(2016)

Part2: 검증대상 암호알고리즘 구현안내서
5
구 분
암호알고리즘
참조표준
전자서명
RSA-PSS 공개키 길이: 2048, 3072
해시함수: SHA2-224/256
국내
[KS X ISO/IEC 14888-2] 부가형 디지털 서명 ­ 제2부: 정수 인수분해 기반
메커니즘 (2021)
국외
[ISO/IEC 14888-2] Digital signatures with appendix Part 2: Integer
factorization based mechanisms (2015)
[FIPS 186-5] Digital Signature Standard (DSS) (2023)
[IETF RFC8017] PKCS#1:RSA CryptographySpecificationsVersion2.2(2016)
KCDSA
공개키, 개인키 길이:
  (2048, 224)
  (2048, 256)
  (3072, 256)
해시함수: SHA2-224/256
국내
[KS X ISO/IEC 14888-3] 부가형 디지털 서명 ­ 제3부: 이산대수 기반
메커니즘 (2021)
[TTAK.KO-12.0001/R4] 부가형 전자 서명 방식 표준 ­ 제2부: 한국형 인증서
기반 전자 서명 알고리즘(KCDSA) (2016)
국외
[ISO/IEC 14888-3] Digital signatures with appendix Part 3: Descrete
logarithm based mechanisms (2018)
ECDSA
P-224/256, B-233/283,
K-233/283
해시함수: SHA2-224/256
국내
[KS X ISO/IEC 14888-3] 부가형 디지털 서명 ­ 제3부: 이산대수 기반
메커니즘 (2021)
[KS X ISO/IEC 15946-1] 타원곡선에 기반한 암호 기술 ­ 제1부: 일반 (2024)
[KS X ISO/IEC 15946-5] 타원곡선에 기초한 암호기법 ­ 제5부: 타원곡선
생성 (2024)
국외
[ISO/IEC 14888-3] Digital signatures with appendix Part 3: Descrete
logarithm based mechanisms (2018)
[ISO/IEC 15946-1] Cryptographic techniques based on elliptic curves
Part 1: General (2016)
[ISO/IEC 15946-5] Cryptographic techniques based on elliptic curves
Part 5: Elliptic curve generation (2022)
[FIPS 186-5] Digital Signature Standard (DSS) (2023)
EC-
KCDSA
P-224/256, B-233/283,
K-233/283
해시함수: SHA2-224/256
국내
[KS X ISO/IEC 14888-3] 부가형 디지털 서명 ­ 제3부: 이산대수 기반
메커니즘 (2021)
[KS X ISO/IEC 15946-1] 타원곡선에 기반한 암호 기술 ­ 제1부: 일반 (2024)
[KS X ISO/IEC 15946-5] 타원곡선에 기초한 암호기법 ­ 제5부: 타원곡선
생성 (2024)
[TTAK.KO-12.0015/R3] 부가형 전자 서명 방식 표준 ­ 제3부: 타원 곡선을
이용한 한국형 인증서 기반 전자 서명 알고리즘 (EC-KCDSA) (2016)
국외
[ISO/IEC 14888-3] Digital signatures with appendix Part 3: Descrete
logarithm based mechanisms (2018)
[ISO/IEC 15946-1] Cryptographic techniques based on elliptic curves
Part 1: General (2016)
[ISO/IEC 15946-5] Cryptographic techniques based on elliptic curves
Part 5: Elliptic curve generation (2022)
[FIPS 186-5] Digital Signature Standard (DSS) (2023)
키 설정
DH
공개키, 개인키 길이:
  (2048, 224)
  (2048, 256)
  (3072, 256)
국내
[KS X ISO/IEC 11770-3] 키 관리 ­ 제3부: 비대칭 기법을 이용한 메커니즘
(2024)
[TTAK.KO-12.0001/R4] 부가형 전자 서명 방식 표준 ­ 제2부: 한국형 인증서
기반 전자 서명 알고리즘(KCDSA) (2016)
국외
[ISO/IEC 11770-3] Key management Part 3: Mechanisms using
asymmetric techniques (2021)

암호모듈 구현안내서
6
표준 일치
▸시험대상 구현물(Implementation Under Test, 이하 IUT)에 구현된 검증대상 암호알고리즘이 관련 표준에 따라
정확하게 구현되었음을 주장하기 위해서는 <암호알고리즘 검증기준>과 <소스코드 및 상세설계서 검토를 통한
검사>에서 다루는 시험들을 통과하여야 한다.
구 분
암호알고리즘
참조표준
키 설정
ECDH
P-224/256, B-233/283,
K-233/283
국내
[KS X ISO/IEC 11770-3] 키 관리 ­ 제3부: 비대칭 기법을 이용한 메커니즘
(2024)
[KS X ISO/IEC 15946-1] 타원곡선에 기반한 암호 기술 ­ 제1부: 일반 (2024)
[KS X ISO/IEC 15946-5] 타원곡선에 기초한 암호기법 ­ 제5부: 타원곡선
생성 (2024)
국외
[ISO/IEC 11770-3] Key management Part 3: Mechanisms using
asymmetric techniques (2021)
[ISO/IEC 15946-1] Cryptographic techniques based on elliptic curves
Part 1: General (2016)
[ISO/IEC 15946-5] Cryptographic techniques based on elliptic curves
Part 5: Elliptic curve generation (2022)
[FIPS 186-5] Digital Signature Standard (DSS) (2023)
키 유도
KBKDF
HMAC, CMAC
국내
[TTAK.KO-12.0333-Part1] HMAC 기반 키 유도 함수 ­ 제1부: 일반 (2018)
[TTAK.KO-12.0333-Part2] HMAC 기반 키 유도 함수 ­ 제2부: 해시 함수
SHA-2 (2018)
[TTAK.KO-12.0333-Part3] HMAC 기반 키 유도 함수 ­ 제3부: 해시 함수
LSH (2018)
[TTAK.KO-12.0333-Part4] HMAC 기반 키 유도 함수 ­ 제4부: 해시 함수
SHA-3 (2019)
[TTAK.KO-12.0272] 블록 암호 기반 키 유도 함수 (2015)
국외
[ISO/IEC 11770-6] Key management Part 6: Key derivation (2016)
PBKDF
HMAC
국내
[TTAK.KO-12.0334-Part1] 패스워드 기반 키 유도 함수 ­ 제1부: 일반 (2018)
[TTAK.KO-12.0334-Part2] 패스워드 기반 키 유도 함수 ­ 제2부: 해시 함수
SHA-2 (2018)
[TTAK.KO-12.0334-Part3] 패스워드 기반 키 유도 함수 ­ 제3부: 해시 함수
LSH (2018)
[TTAK.KO-12.0334-Part4] 패스워드 기반 키 유도 함수 ­ 제4부: 해시 함수
SHA-3 (2019)
국외
[IETF
RFC
8018]
PKCS
#5:
Password-Based
Cryptography
Specification Version 2.1 (2017)
6

Part2: 검증대상 암호알고리즘 구현안내서
7
문서의 구성
▸안내서는 총 15장으로 구성되며, 1장에서는 안내서의 목적, 법적근거, 그리고 안내서의 대상이 되는 검증대상
알고리즘을 다룬다.
▸2장에서 15장까지는 검증대상 알고리즘에 포함된 각 알고리즘에 대하여, 간략한 소개와 함께 구현 시 고려사항을
기술한다.
▸고려사항은 암호모듈에 입력되는 데이터 처리 메커니즘을 주로 확인하는 입력조건에 대한 항목과 내부 데이터
생성, 제로화, 예외 사항처리 등을 포함한 내부조건에 대한 항목으로 나누어서 기술한다.
▸ 2장 블록암호운영모드는ARIA,SEED, LEA, HIGHT, AES 블록암호 운영모드ECB, CBC, CTR, CFB, OFB에 대한
구현 시 고려사항을 다룬다.
▸ 3장 블록암호 운영모드(인증암호화)는 인증암호화 운영모드 GCM, CCM에 대한 구현 시 고려사항을 다룬다.
▸ 4장 블록암호 기반 메시지인증코드는 블록암호를 내부적으로 이용하는 CMAC, GMAC 알고리즘의 구현 시
고려사항을 다룬다.
▸ 5장 해시함수 기반 메시지인증코드는 HMAC에 대한 구현 시 고려사항을 다룬다.
▸ 6장 블록암호 기반 난수발생기는 내부적으로 블록암호(ARIA, SEED, LEA, AES, HIGHT)를 사용하는 난수발생기
(CTR_DRBG)의 구현 시 고려사항을 다룬다.
▸ 7장 해시함수 기반 난수발생기는 해시함수를 사용하는 난수발생기(Hash_DRBG), HMAC을 사용하는 난수발생기
(HMAC_DRBG)의 구현 시 고려사항을 다룬다.
▸ 8장 공개키 암호는 IF(Integer Factorization)에 기반을 둔 RSAES 공개키 암호의 구현 시 고려사항을 다룬다.
▸ 9장 RSA 기반 전자서명은 IF(Integer Factorization)에 기반을 둔 RSA-PSS 전자서명의 구현 시 고려사항을
다룬다.
▸10장 이산대수 기반 전자서명은 DLP(Discrete Logarithm Progblem)에 기반을 둔 KCDSA 전자서명의 구현 시
고려사항을 다룬다.
▸11장 타원곡선 기반 전자서명은 EC(Elliptic Curve)-DLP에 기반을 둔 ECDSA, EC-KCDSA 전자서명의 구현 시
고려사항을 다룬다.
▸12장이산대수 기반 키 설정은 DLP(Discrete Logarithm Problem)에 기반을둔 DH 키 설정알고리즘의 구현시
고려사항을 다룬다.
▸13장타원곡선기반키설정은EC(EllipticCurve)-DLP에기반을둔ECDH키설정알고리즘의구현시고려사항을
다룬다.
▸14장 패스워드 기반 키 유도는 HMAC PRF를 사용하는 PBKDF의 구현 시 고려사항을 다룬다.
▸15장 의사난수 함수 기반 키 유도는 HMAC, CMAC PRF를 CTR, FB, DP 모드로 운용하는 KBKDF의 구현 시
고려사항을 다룬다.
7

암호모듈 구현안내서
8
용어 정의 및 약어
가. 용어 정의
정 의
의 미
난수
생성되기 전에 예측할 수 없는 값으로, 암호시스템에서 난수는 암호 키, 논스, 솔트 등의 목적으로
사용됨
논스
특정 조건하에서 한번만 사용되는 값
평문
암호화 대상이 되는 문자열 및 암호문을 복호화한 본래의 문자열
암호문
평문으로 된 정보를 암호 처리하여 특정인만 이용할 수 있도록 암호화한 문자열
암호화
암호화 키를 사용하여 평문을 암호문으로 변환하는 것
보안 강도
해당 암호알고리즘 또는 암호시스템이 공격자로부터 데이터를 보호할 수 있는 계량화된 수준
복호화
복호화 키를 사용하여 암호문을 본래의 평문으로 복원하는 것
부가인증
데이터
메시지 인증 함수의 입력 데이터로서 인증되지만 암호화되지 않은 데이터
(메시지 인증코드 부분으로 이동)
블록
운영모드의 처리 단위
블록암호 운영모드
블록 암호를 이용하여 임의의 크기를 갖는 데이터를 암/복호화하기 위해 적용하는 방식
비밀키
대칭키 암호알고리즘과 함께 사용되며, 하나 또는 여러 객체에서 유일하게 결합되는 암호키이므로,
공개되어서는 안 됨
씨드
암호함수 또는 난수생성의 초기화를 위해 사용되는 비밀 값
인증 값
우연히 발생한 에러와 데이터의 의도적인 조작을 모두 발견할 수 있도록 설계된 데이터로 해당
비밀키를 소유한 경우에만 확인할 수 있음
엔트로피
데이터가 가지는 정보량을 수치적으로 나타낸 것으로, 난수성에 대한 정량화된 지표
키 유도
하나의 암호 키로부터 대칭키 암호알고리즘의 암호 키들로 사용할 수 있는 키 요소를 얻는 과정
패딩
평문에 특정한 데이터를 채워서 운영모드 블록 크기의 배수로 만드는 기법
핵심보안매개변수
노출 또는 변경 시, 암호알고리즘 또는 암호모듈의 안전성을 크게 저하시키는 정보
(예: 암호키, 개인키, 패스워드, 난수발생기 내부 상태 등)
8

Part2: 검증대상 암호알고리즘 구현안내서
9
나. 약어
약 어
의 미
CBC
Cipher Block Chaining
CFB
Cipher Feedback
PT / CT
Plaintext / Ciphertext
CTR
Counter Mode
CTR_DRBG
Block cipher-based Deterministic Random Bit Generator
CCM
Counter Mode with CBC-MAC
CMAC
Cipher-based Message Authentication Code
ENC / DEC
Encryption / Decryption
DH
Diffie-Hellman
DRBG
Deterministic Random Bit Generator
ECB
Electronic CodeBook
ECDH
Elliptic Curve Diffie-Hellman
ECDSA
Elliptic Curve Digital Signature Algorithm
EC-KCDSA
Elliptic Curves-Korean Certificate based-Digital Signature Algorithm
EM
Encoded Message
FIPS
Federal Information Processing Standard
GCM
Galois/Counter Mode of Operation
Hash_DRBG
Hash-based Deterministic Random Bit Generator
HMAC
Hash-based Message Authentication Code
HMAC_DRBG
HMAC-based Deterministic Random Bit Generator
IV
Initial Vector
KBKDF
Key-Based Key Derivation Function
KCDSA
Korean Certificate based-Digital Signature Algorithm
MAC
Message Authentication Code
LSH
Lightweight Secure Hash
OFB
Output FeedBack
PBKDF
Password-Based Key Derivation Function
RSAES
RSA Encryption Scheme
RSA-PSS
RSA signature scheme with appendix based on the Probabilistic Signature Scheme
SHA
Secure Hash Algorithm
XOR
Exclusive OR

GVI
Part 2
Guide for 
Vendor 
 Implementations

2장 블록암호 운영모드
(일반)

암호모듈 구현안내서
12
범위
q 본 문서에서는 블록암호 운영모드 중 암･복호화 전용 운영모드를 구현하기 위한 고려사항을 기술한다.
암･복호화 전용 운영모드
ECB, CBC, CFB, OFB, CTR
관련표준
▸[KS X ISO/IEC 10116] n비트 블록 암호 운영모드 (2021)
▸[ISO/IEC 10116] Modes of operation for an n-bit block cipher (2017)
기호
블록암호 운영모드(일반)
기 호
의 미

비트열 의 비트 길이

블록암호 알고리즘이 한 번의 연산으로 처리할 수 있는 1블록의 길이 (비트)

번째 평문 블록 ()

번째 암호문 블록 ()

암‧복호화 시 사용하는 키

암호화 알고리즘

복호화 알고리즘

 운영모드에서 사용되는 초기값

 운영모드에서 사용되는 피드백 길이

 운영모드에서 사용되는 초기값

비트열 의 하위 비트를 1만큼 증가시키는 함수 (상위 비트는 고정)
 ※ mod 

주어진 비트열 의 상위(왼쪽) 개 비트열

주어진 비트열 의 하위(오른쪽) 개 비트열
1
2
3

Part2: 검증대상 암호알고리즘 구현안내서
13
블록암호 운영모드
▸블록암호는 블록 단위로 암･복호화를 수행하는 알고리즘이다. 그러나 일반적으로 암호화 하고자 하는 평문의
길이는 한 블록 이상이며 매우 다양한 길이로 구성된다. 이처럼 임의의 길이를 갖는 데이터를 암･복호화하기
위해 입･출력 크기가 고정된 블록암호 알고리즘을 적용하는 방식을 블록암호 알고리즘의 운영모드라고 한다.
▸블록암호의 안전성에 영향을 끼치는 요소로는 비밀키의 길이, IV의 길이, 패딩 기법 등이 있다.
운영모드 명세 및 구현 시 고려사항
가. ECB (Electronic CodeBook)
ECB 운영모드
특징
－ 동일한 평문에 대하여 동일한 암호문을 생성함
－ 암호화/복호화 모두 병렬처리 가능
－ 특정 암호문 블록만 복호화 가능
－ 메시지 길이가 1블록 이하인 경우 패딩 필요
권고사항
－ 블록암호 알고리즘이 처리할 수 있는 1블록 길이를 초과하는 평문 입력 금지
[ECB 모드 암호화 과정]
[ECB 모드 복호화 과정]
ECB 모드 암호화(ECB_Enc )
고려사항
입력
－ 평문 ⋯
－ 비밀키 
①, ②, ③, ④
출력
－ 암호문 ⋯
1
for  from  to  do
2
      
3
      
4
      
5
end for
4
5

암호모듈 구현안내서
14
ECB 모드 복호화(ECB_Dec )
고려사항
입력
- 암호문 ⋯
- 비밀키 
①, ③, ④
출력
- 평문 ⋯
1
for  from  to  do
2
      
3
      
4
      
5
end for
① 비밀키 길이 확인
블록암호별 지원 가능한 키 길이 확인
– ARIA, LEA, AES의 비밀키 길이: 128/192/256 비트
– SEED, HIGHT의 비밀키 길이: 128 비트
② 안전한 비밀키 생성
블록암호 비밀키는 “중요보안매개변수(SSP) 생성” 방법으로 생성되어야 함
(검증대상 난수발생기를 이용하여 생성하는 등 안전한 방법으로 생성)
③ 평문/암호문 길이 확인
블록암호별 처리 가능한 평문/암호문 길이 확인
– ARIA, SEED, LEA, AES의 평문 길이: 128 비트
– HIGHT의 평문 길이: 64 비트
※ 암호문의 경우 적용된 패딩 알고리즘을 고려하여 처리 가능한 길이를 확인해야 함
④ 패딩 알고리즘
블록암호의 평문은 기본 블록길이의 배수가 되어야 하며, 그렇지 않을 경우 입력되는 평문의 길이가 기본
블록길이의 배수가 되도록 권고된 패딩방법 적용
패딩이 적용된 평문으로부터 생성된 암호문을복호화할 경우에는, 복호화한 결과에서패딩방법의 유효성을 검증한 후
패딩값을 제외해야 함
※ [부록] “안전한 패딩 방법” 참고
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

Part2: 검증대상 암호알고리즘 구현안내서
15
나. CBC (Cipher Block Chaining)
CBC 운영모드
특징
－ 이전 평문 블록에 대한 암호문 블록이 다음 평문 블록과 XOR된 후 암호화됨
   (첫 번째 평문 블록은 IV와 XOR된 후 암호화됨)
－ 평문, IV의 변조는 암호문 블록에 영향을 미침
－ 한 암호문 블록의 변조는 해당 블록과 다음 블록까지 영향을 미침
－ 복호화만 병렬처리 가능
－ 특정 암호문 블록만 복호화 가능
－ 메시지 길이가 1블록 이하인 경우 패딩 필요
권고사항
－ IV는 예측 불가능한 값이어야 함
[CBC 모드 암호화 과정]
[CBC 모드 복호화 과정]
CBC 모드 암호화(CBC_Enc )
고려사항
입력
－ 초기값  
－ 평문 ⋯
－ 비밀키 
①, ②, ③, ④
출력
－ 암호문 ⋯
1

2
for  from  to  do
3
      ⊕
4
      
5
      
6
end for

암호모듈 구현안내서
16
CBC 모드 복호화(CBC_Dec )
고려사항
입력
－ 초기값  
－ 암호문 ⋯
－ 비밀키 
①, ③
출력
－ 평문 ⋯
1

2
for  from  to  do
3
      
4
      
5
      ⊕
6
end for
① 비밀키 길이 확인
블록암호별 지원 가능한 키 길이 확인
– ARIA, LEA, AES의 비밀키 길이: 128/192/256 비트
– SEED, HIGHT의 비밀키 길이: 128 비트
② 안전한 비밀키 생성
블록암호 비밀키는 “중요보안매개변수(SSP) 생성” 방법으로 생성되어야 함
(검증대상 난수발생기를 이용하여 생성하는 등 안전한 방법으로 생성)
③ 패딩 알고리즘
블록암호의 평문은 기본 블록길이의 배수가 되어야 하며, 그렇지 않을 경우 입력되는 평문의 길이가 기본
블록길이의 배수가 되도록 권고된 패딩방법 적용
패딩이 적용된 평문으로부터 생성된 암호문을복호화할 경우에는, 복호화한 결과에서패딩방법의 유효성을 검증한 후
패딩값을 제외해야 함
※ [부록] “안전한 패딩 방법” 참고
④ 안전한 IV 생성
초기값 IV는 각각의 암호화 단계에서 생성
IV는 예측 불가능한 값이어야 하며, 다음 두 가지 방법을 통해 생성해야 함
1) 사용되지 않은(Unique) 값(예: nonce 등)을 암호화에 사용하는 비밀키 로 암호화한 결과값을 IV로 사용
2) 검증대상 난수발생기를 이용
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

Part2: 검증대상 암호알고리즘 구현안내서
17
다. CFB (Cipher Feedback)
CFB 운영모드
특징
－ 이전 평문 블록에 대한 암호문 블록이 다음 암호화의 입력이 됨
－ 자가 동기화된 스트림 암호형태이기 때문에 특정 암호문 블록이 소실되는 경우 원본 메시지의 일부분을
복호화하지 못함
－ 평문 블록의 변조는 이후의 모든 암호문 블록에 영향을 미침
－ 블록암호 알고리즘의 암호화 알고리즘만 구현하면 됨
－ 복호화만 병렬처리 가능
－ 특정 암호문 블록만 복호화 가능
권고사항
－ IV는 예측 불가능한 값이어야 함
[CFB 모드 암호화 과정]
[CFB 모드 복호화 과정]

암호모듈 구현안내서
18
CFB 모드 암호화(CFB_Enc )
고려사항
입력
－ 초기값  
－ 피드백 길이 
－ 평문 ⋯
        ≤≤≤
－ 비밀키 
①, ②, ③, ④
출력
－ 암호문 ⋯
1

2
for  from  to  do
3
      
4
      ⊕
5
      
6
end for
7

8
⊕
CFB 모드 복호화(CFB_Dec )
고려사항
입력
－ 초기값  
－ 피드백 길이 
－ 암호문 ⋯
          ≤≤≤
－ 비밀키 
①, ④
출력
－ 평문 ⋯
1

2
for  from  to  do
3
      
4
      ⊕
5
           
6
end for
7

8
⊕
① 비밀키 길이 확인
블록암호별 지원 가능한 키 길이 확인
– ARIA, LEA, AES의 비밀키 길이: 128/192/256 비트
– SEED, HIGHT의 비밀키 길이: 128 비트

Part2: 검증대상 암호알고리즘 구현안내서
19
② 안전한 비밀키 생성
블록암호 비밀키는 “중요보안매개변수(SSP) 생성” 방법으로 생성되어야 함
(검증대상 난수발생기를 이용하여 생성하는 등 안전한 방법으로 생성)
③ 안전한 IV 생성
초기값 IV는 각각의 암호화 단계에서 생성
IV는 예측 불가능한 값이어야 하며, 다음 두 가지 방법을 통해 생성해야 함
1) 사용되지 않은(Unique) 값(예: nonce 등)을 암호화에 사용하는 비밀키 로 암호화한 결과값을 IV로 사용
2) 검증대상 난수발생기를 이용
④ 피드백 길이 확인
블록암호별 가능한 피드백 길이(비트 단위) 확인
– ARIA, SEED, LEA, AES의 피드백 길이: ≤≤
– HIGHT의 피드백 길이: ≤≤
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

암호모듈 구현안내서
20
라. OFB (Output Feedback)
OFB 운영모드
특징
－ 동기화된 스트림 암호와 유사하게 평문은 암호연산의 출력과 XOR되어 암호문이 되며, 암호연산의 출력은
다음 암호연산의 입력이 됨
－ 암호문 블록의 특정 비트 오류는 해당 평문 블록의 동일한 위치에서 비트 오류를 발생시킴
－ 암호화와 복호화의 구조가 동일
－ 블록암호 알고리즘의 암호화 알고리즘만 구현하면 됨
－ 병렬처리 불가능
－ 특정 암호문 블록 복호화 불가능
권고사항
－ IV는 암호 연산의 각 실행에 대해 유일해야 함
[OFB 모드 암호화 과정]
[OFB 모드 복호화 과정]

Part2: 검증대상 암호알고리즘 구현안내서
21
OFB 모드 암호화(OFB_Enc )
고려사항
입력
－ 초기값  
－ 평문 ⋯
        ≤≤
         ≤
－ 비밀키 
①, ②, ③
출력
－ 암호문 ⋯
1

2
for  from  to  do
3
      
4
      ⊕
5
      
6
end for
7

8
⊕
OFB 모드 복호화(OFB_Dec )
고려사항
입력
－ 초기값  
－ 암호문 ⋯
          ≤≤
           ≤
－ 비밀키 
①
출력
－ 평문 ⋯
1

2
for  from  to  do
3
      
4
      ⊕
5
      
6
end for
7

8
⊕
① 비밀키 길이 확인
블록암호별 지원 가능한 키 길이 확인
– ARIA, LEA, AES의 비밀키 길이: 128/192/256 비트
– SEED, HIGHT의 비밀키 길이: 128 비트
② 안전한 비밀키 생성
블록암호 비밀키는 “중요보안매개변수(SSP) 생성” 방법으로 생성되어야 함
(검증대상 난수발생기를 이용하여 생성하는 등 안전한 방법으로 생성)

암호모듈 구현안내서
22
③ 안전한 IV 생성
초기값 IV는 각각의 암호화 단계에서 생성
IV는 암호 연산의 각 실행에 대해 유일해야 함
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

Part2: 검증대상 암호알고리즘 구현안내서
23
마. CTR (Counter)
CTR 운영모드
특징
－ 카운터를 암호화한 후 각 평문 블록과 XOR하여 암호문 블록을 계산
－ 암호화와 복호화의 구조가 동일
－ 블록암호 알고리즘의 암호화 알고리즘만 구현하면 됨
－ 암호화/복호화 모두 병렬처리 가능
－ 특정 암호문 블록만 복호화 가능
권고사항
－ 카운터가 최대값에 도달하였을 때 적절한 처리 필요
－ 카운터는 동일한 비밀키로 암호화되는 모든 평문 블록에 대해 유일해야 함
[CTR 모드 암호화 과정]
[CTR 모드 복호화 과정]

암호모듈 구현안내서
24
CTR 모드 암호화(CTR_Enc )
고려사항
설정
－  :  가변 필드의 비트 길이 ≤
입력
－ 초기값  
－ 평문 ⋯
   ≤≤≤
－ 비밀키 
①, ②, ③
출력
－ 암호문 ⋯
1

2
for  from  to  do
3
      
4
      ⊕
5
      
6
end for
7

8
⊕
CTR 모드 복호화(CTR_Dec )
고려사항
설정
－  :  가변 필드의 비트 길이 ≤
입력
－ 초기값  
－ 암호문 ⋯
   ≤≤≤
－ 비밀키 
①
출력
－ 평문 ⋯
1

2
for  from  to  do
3
      
4
      ⊕
5
      
6
end for
7

8
⊕
① 비밀키 길이 확인
블록암호별 지원 가능한 키 길이 확인
– ARIA, LEA, AES의 비밀키 길이: 128/192/256 비트
– SEED, HIGHT의 비밀키 길이: 128 비트

Part2: 검증대상 암호알고리즘 구현안내서
25
② 안전한 비밀키 생성
블록암호 비밀키는 “중요보안매개변수(SSP) 생성” 방법으로 생성되어야 함
(검증대상 난수발생기를 이용하여 생성하는 등 안전한 방법으로 생성)
③ 안전한 CTR 생성
초기값 은 각각의 암호화 단계에서 생성
번째 블록 연산에 사용되는 는 동일한 비밀키로 암호화되는 모든 평문 블록에 대해 유일해야 함
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

GVI
Part 2
Guide for 
Vendor 
 Implementations

3.2 내용추가 예정
3장 블록암호 운영모드
(인증암호화)

암호모듈 구현안내서
28
범위
q 본 문서에서는 블록암호 운영모드 중 인증암호화 운영모드(GCM, CCM)를 구현하기 위한 고려사항을 기술한다.
블록암호
인증암호화 운영모드
ARIA, SEED, LEA, AES
GCM, CCM
관련표준
▸[KS X ISO/IEC 19772] 인증된 암호화 (2024)
▸[ISO/IEC 19772] Authenticated Encryption (2020)
 
기호
블록암호 운영모드(인증암호화)
기 호
의 미

비트열 의 비트 길이

블록암호 알고리즘이 한 번의 연산으로 처리할 수 있는 1블록의 길이 (비트)

평문

부가 인증 데이터

인증암호화 시 사용하는 비밀키

암호문

인증값

GCM 운영모드에서 사용되는 초기값

비밀키 를 이용하여 입력값 를 암호화하는 블록암호 암호화 함수

길이의 연속된  비트열 (Ex. , )

길이의 연속된  비트열 (Ex. , )

주어진 비트열 의 상위(왼쪽) 개 비트열

주어진 비트열 의 하위(오른쪽) 개 비트열

비트열 의 하위 비트를 1만큼 증가시키는 함수 (상위 비트는 고정)
 ※ mod 
⌈⌉
보다 크거나 같은 정수 중에서 최소값
1
2
3

Part2: 검증대상 암호알고리즘 구현안내서
29
블록암호 운영모드(인증암호화)
▸[블록암호 운영모드(일반)]은 메시지의 기밀성만 제공하는 반면, 인증암호화 운영모드는 메시지의 기밀성과 인증
기능을 동시에 제공하는 운영모드로 GCM과 CCM으로 구성된다. 블록암호는 검증대상 암호알고리즘인 ARIA,
SEED, LEA, AES를 사용할 수 있다.
기 호
의 미

음이 아닌 정수 의 비트 이진수 표현

초기값(카운터) , 평문 , 비밀키 인 블록암호 CTR 운영모드 암호화 함수

서브키 를 사용하는 GCM 모드의 내부 해시함수

유한체  상에서 비트열 와의 곱셈 연산

CCM 운영모드에서 사용되는 논스

CCM 운영모드에서 평문 의 길이를 명세하는 첫 번째 블록()에 포함되는 필드 의 바이트 길이
4

암호모듈 구현안내서
30
알고리즘 명세 및 구현 시 고려사항
가. GCM
▸GCM(Galois/Counter Mode)은 CTR 모드에 유한체 GF()에서의 곱 연산을 이용한 메시지 인증 기능을
추가한 형태로 메시지의 기밀성과 인증을 동시에 제공한다. 입력 메시지에 대하여 인증만을 제공하기 위해
적용되는GCM은GMAC이라한다.GCM은AE(AuthenticatedEncryption)와AD(AuthenticatedDecryption)
두 부분으로 구분된다.
□ 암호화 단계 (AE)
■ CTR 및 GHASH 함수


5

Part2: 검증대상 암호알고리즘 구현안내서
31
■ MulH 연산
←∙ in 
1.  입력
1. 
2. 
3. 
4. for  from  to  do
4.  

if 
⊕if 
≫
if 
≫⊕if 
5.  출력
GCM 모드 암호화(GCM-AE )
고려사항
입력
－ 평문 
－ 부가 인증 데이터 
－ 초기값 
－ 비밀키 
－ 인증값 길이 
①, ②, ③
출력
－ 암호문 
－ 인증값  ()
1

2
if


⌈⌉

3

4
⌈⌉
5
⌈⌉
6

7
⊕
8
(암호문 , 인증값 ) 출력
① 입력값 길이 확인
GCM 운영모드에서 허용되는 입력값 길이 확인
– 평문  : ≤≤ 비트
– 부가 인증 데이터  : ≤≤ 비트
– 초기값  : ≤≤ 비트
– 인증값 길이  : ≤≤ 비트

암호모듈 구현안내서
32
② 비밀키 생성 방법 및 길이 확인
비밀키는 “중요보안매개변수(SSP) 생성” 방법으로 생성되어야 함
(검증대상 난수발생기를 이용하여 생성하는 등 안전한 방법으로 생성)
블록암호별 지원 가능한 키 길이 확인
– ARIA, LEA, AES의 비밀키 길이: 128/192/256 비트
– SEED의 비밀키 길이: 128 비트
③ 안전한 IV 생성 및 관리
암호모듈 구현안내서(GVI Part 1) C.1 참조
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

Part2: 검증대상 암호알고리즘 구현안내서
33
□ 복호화 단계 (AD)
■ CTR 및 GHASH 함수


■ MulH 연산
←∙ in 
1.  입력
1. 
2. 
3. 
4. for  from  to  do
4.  

if 
⊕if 
≫
if 
≫⊕if 
5.  출력

암호모듈 구현안내서
34
GCM 모드 복호화(GCM-AD )
고려사항
입력
－ 암호문 
－ 부가 인증 데이터 
－ 초기값 
－ 비밀키 
－ 인증값 
①, ②
출력
－ 평문  또는 
1

2
if


⌈⌉

3

③
4
⌈⌉
5
⌈⌉
6

7
′ ⊕
8
if′
     평문  출력

      출력
① 입력값 길이 확인
GCM 운영모드에서 허용되는 입력값 길이 확인
– 암호문  : ≤≤ 비트
– 부가 인증 데이터  : ≤≤ 비트
– 초기값  : ≤≤ 비트
– 인증값  : ≤≤ 비트
② 비밀키 길이 확인
블록암호별 지원 가능한 키 길이 확인
– ARIA, LEA, AES의 비밀키 길이: 128/192/256 비트
– SEED의 비밀키 길이: 128 비트
③ 복호화 수행 시점
구현 효율성을 고려하여 [단계 8]에서 if′ 조건을 만족한 경우,
해당 시점에 [단계 3]을 수행하여 평문  출력 가능
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

Part2: 검증대상 암호알고리즘 구현안내서
35
나. CCM
▸CCM(Counter Mode with CBC-MAC)은 CTR 모드와 CBC-MAC 메시지 인증 방식을 결합한 구조이다. CCM은
인증값생성및암호화(GE :GenerationEncryption)와인증값검증및복호화(DV :DecryptionVerification)
두 부분으로 구분된다.
▸CCM모드의FormattingFunction및CounterGenerationFunction에는요구조건을만족하는다양한방법이
적용될 수 있으나, 본 구현안내서에서는 IEEE Standard 802.11의 CCM 명세를 적용한다.
※ IEEE Standard 802.11 (Part 11)
□ 암호화 단계

암호모듈 구현안내서
36
Formatting_Function
고려사항
설정
－  : 필드 의 바이트 길이
－  : 인증값의 바이트 길이
입력
－ 평문 
－ 부가 인증 데이터 
－ 논스 
출력
－ 인코딩된 비트열 
1
if
     

     
2


3

4
if
     if
          mod 
     if≤
          mod 
     if≤
          mod 
5
mod 
6
비트열  출력
Counter_Generation_Function
고려사항
설정
－  : 필드 의 바이트 길이
입력
－ 논스 
출력
－ 카운터 비트열 
1

2

3
비트열  출력

Part2: 검증대상 암호알고리즘 구현안내서
37
CCM 모드 암호화(CCM-GE )
고려사항
입력
－ 평문 
－ 부가 인증 데이터 
－ 논스 
－ 비밀키 
－ 인증값 바이트 길이 
①, ③
출력
－ 암호문 
1
⋯_ ()
②
2

3
for  from  to  do

4
      ⊕
5
end for
6

7
__
8
⊕
9
′ 
10
′ 
11
암호문  출력
① 비밀키 생성 방법 및 길이 확인
비밀키는 “중요보안매개변수(SSP) 생성” 방법으로 생성되어야 함
(검증대상 난수발생기를 이용하여 생성하는 등 안전한 방법으로 생성)
블록암호별 지원 가능한 키 길이 확인
– ARIA, LEA, AES의 비밀키 길이: 128/192/256 비트
– SEED의 비밀키 길이: 128 비트
② Formatting Function 파라미터 확인
Formatting Function의 파라미터가 아래의 조건을 만족하는지 확인
– 평문 의 길이를 명세하는 첫 번째 블록()에 포함된 필드 의 바이트 길이()
  : ∈
– 논스 의 바이트 길이() : ∈
– 

암호모듈 구현안내서
38
③ 입력값 길이 확인
CCM 운영모드에서 허용되는 입력값 길이 확인
– 평문 의 바이트 길이() : ≤≤ 바이트
– 부가 인증 데이터 의 바이트 길이() : ≤≤ 바이트
– 논스  : 
– 인증값 바이트 길이  : ( 또는 ) 바이트
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고
□ 복호화 단계

Part2: 검증대상 암호알고리즘 구현안내서
39
CCM 모드 복호화(CCM-DV )
고려사항
입력
－ 암호문 
－ 부가 인증 데이터 
－ 논스 
－ 비밀키 
－ 인증값 바이트 길이 
①, ③
출력
－ 평문  또는 
1
if≤인 경우,  출력
2
__
3

4
′ 
5
′ ⊕
6
′
7
⋯_ ()
②
8

9
for  from  to  do
10
      ⊕
11
end for
12
if′ 
     평문  출력

      출력
① 비밀키 길이 확인
블록암호별 지원 가능한 키 길이 확인
– ARIA, LEA, AES의 비밀키 길이: 128/192/256 비트
– SEED의 비밀키 길이: 128 비트
② Formatting Function 파라미터 확인
Formatting Function의 파라미터가 아래의 조건을 만족하는지 확인
– 평문 의 길이를 명세하는 첫 번째 블록()에 포함된 필드 의 바이트 길이()
  : ∈
– 논스 의 바이트 길이() : ∈
– 

암호모듈 구현안내서
40
③ 입력값 길이 확인
CCM 운영모드에서 허용되는 입력값 길이 확인
– 암호문 의 바이트 길이() : ≤≤ 바이트
– 부가 인증 데이터 의 바이트 길이() : ≤≤ 바이트
– 논스  : 
– 인증값 바이트 길이  : ( 또는 ) 바이트
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

4장 블록암호 기반 
메시지인증코드

암호모듈 구현안내서
42
범위
q 본 문서에서는 블록암호 기반 메시지인증코드(MAC)의 구현 시 고려사항을 기술한다.
q 블록암호별 적용되는 메시지인증코드는 다음과 같다.
블록암호
적용 가능한 MAC
ARIA, SEED, LEA, AES
GMAC, CMAC
HIGHT
CMAC
관련표준
▸[KS X ISO/IEC 9797-1] 메시지 인증 코드 – 제1부: 블록 암호를 이용한 메커니즘 (2023)
▸[KS X ISO/IEC 9797-3] 메시지 인증 코드 – 제3부: 유니버셜 해시 함수를 사용하는 메커니즘 (2024)
▸[KS X ISO/IEC 19772] 인증된 암호화 (2024)
▸[ISO/IEC 9797-1] Message Authentication Codes (MACs) - Part 1: Mechanisms using a block cipher
(2011)
▸[ISO/IEC 9797-3] Message Authentication Codes (MACs) - Part 3: Mechanisms using a universal
hash-function (2011)
▸[ISO/IEC 19772] Authenticated Encryption (2020)
블록암호 기반 메시지인증코드
1
2

Part2: 검증대상 암호알고리즘 구현안내서
43
기호
기 호
의 미

비트열 의 비트 길이

블록암호 알고리즘이 한 번의 연산으로 처리할 수 있는 1블록의 길이 (비트)

평문 메시지

비밀키

초기값

메시지인증코드

메시지인증코드 길이(비트)

비밀키 를 이용하여 입력값 를 암호화하는 블록암호 암호화 함수

길이의 연속된  비트열 (Ex. , )

길이의 연속된  비트열 (Ex. , )

비트열 의 하위 비트를 1만큼 증가시키는 함수 (상위 비트는 고정)
 ※ mod 
⌈⌉
보다 크거나 같은 정수 중에서 최소값

음이 아닌 정수 의 비트 이진수 표현

초기값 , 평문 , 비밀키 K인 블록암호 CTR 모드 암호화 함수

서브키 를 사용하는 GCM 모드의 내부 해시함수

주어진 비트열 의 상위(왼쪽) 개 비트열

유한체  상에서 비트열 와의 곱셈 연산
블록암호 기반 메시지 인증코드
▸블록암호 기반 메시지 인증코드는 메시지 인증 기능을 제공하는 블록암호 운영모드 중 GMAC, CMAC으로
구성되며,블록암호는검증대상암호알고리즘인ARIA,SEED,LEA,AES를사용할수있다.블록암호HIGHT는
CMAC에만 적용할 수 있다.
3
4

암호모듈 구현안내서
44
알고리즘 명세 및 구현 시 고려사항
가. GMAC
▸GCM(Galois/Counter Mode)은 CTR 모드에 유한체 GF()에서의 곱 연산을 이용한 메시지 인증 기능을 추가한
형태로메시지의기밀성과인증을동시에제공한다.입력메시지에대하여인증만을제공하기위해적용되는GCM을
GMAC이라 한다.
□ MAC 생성 단계
■ GHASH 함수

■ MulH 연산
←∙ in 
1.  입력
1. 
2. 
3. 
4. for  from  to  do
4.  

if 
⊕if 
≫
if 
≫⊕if 
5.  출력
5

Part2: 검증대상 암호알고리즘 구현안내서
45
GMAC 생성 함수(GMAC-Gen )
고려사항
입력
－ 메시지 
－ 초기값 
－ 비밀키 
－ 메시지인증코드 길이 
①, ②, ③
출력
－ 길이가 m인 메시지인증코드 
1

2
if


⌈⌉

3
⌈⌉
4

5
⊕
6
메시지인증코드  출력
① 입력값 길이 확인
GMAC 운영모드에서 허용되는 입력값 길이 확인
– 메시지  : ≤≤ 비트
– 초기값  : ≤≤ 비트
– 메시지인증코드 길이  : ≤≤ 비트
② 비밀키 생성 방법 및 길이 확인
블록암호 비밀키는 “중요보안매개변수(SSP) 생성” 방법으로 생성되어야 함
(검증대상 난수발생기를 이용하여 생성하는 등 안전한 방법으로 생성)
블록암호별 지원 가능한 키 길이 확인
– ARIA, LEA, AES의 비밀키 길이: 128/192/256 비트
– SEED의 비밀키 길이: 128 비트
③ 안전한 IV 생성 및 관리
암호모듈 구현안내서(GVI Part 1) C.1 참조
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

암호모듈 구현안내서
46
□ MAC 검증 단계
■ GHASH 함수

■ MulH 연산
←∙ in 
1.  입력
1. 
2. 
3. 
4. for  from  to  do
4.  

if 
⊕if 
≫
if 
≫⊕if 
5.  출력

Part2: 검증대상 암호알고리즘 구현안내서
47
GMAC 검증 함수(GMAC-Ver )
고려사항
입력
－ 메시지 
－ 초기값 
－ 비밀키 
－ 메시지인증코드 
①, ②
출력
－  또는 
1

2
if


⌈⌉

3
⌈⌉
4

5
⊕
6
if
      출력

      출력
① 입력값 길이 확인
GMAC 운영모드에서 허용되는 입력값 길이 확인
– 메시지  : ≤≤ 비트
– 초기값  : ≤≤ 비트
– 메시지인증코드  : ≤≤ 비트
② 비밀키 길이 확인
블록암호별 지원 가능한 키 길이 확인
– ARIA, LEA, AES의 비밀키 길이: 128/192/256 비트
– SEED의 비밀키 길이: 128 비트
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

암호모듈 구현안내서
48
나. CMAC
▸CMAC(Cipher-based Message Authentication Code)은 CBC-MAC의 한 변형이다. CMAC은 인증값의
생성(Generation)과 검증(Verification) 두 부분으로 구분된다.
□ MAC 생성 단계
CMAC 생성 함수(CMAC-Gen )
고려사항
입력
－ 메시지 ⋯
          ≤≤≤
－ 비밀키 
－ 메시지인증코드 길이 
①, ②
출력
－ 길이가 인 메시지인증코드 
1

2
if

if

보조 비밀키  생성
3
if
≪

≪⊕

Part2: 검증대상 암호알고리즘 구현안내서
49
① 입력값 길이 확인
블록암호별 지원 가능한 키 및 MAC 길이() 확인
– ARIA, LEA, AES의 비밀키 길이: 128/192/256 비트
– SEED, HIGHT의 비밀키 길이: 128 비트
– ARIA, SEED, LEA, AES의 MAC 길이 : ≤≤ 비트
– HIGHT의 MAC 길이 :  비트
② 안전한 비밀키 생성
비밀키는 “중요보안매개변수(SSP) 생성” 방법으로 생성되어야 함
(검증대상 난수발생기를 이용하여 생성하는 등 안전한 방법으로 생성)
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고
보조 비밀키  생성
4
if
≪

≪⊕
5
if


⌈⌉
6
if
⊕

⊕
7

8
for  from  to  do
9
      ⊕
10
end for
11

12
메시지인증코드  출력

암호모듈 구현안내서
50
□ MAC 검증 단계
CMAC 검증 함수(CMAC-Ver )
고려사항
입력
－ 메시지 ⋯
          ≤≤≤
－ 비밀키 
－ 메시지인증코드 
①, ②
출력
－  또는 
1

2
if

if

보조 비밀키  생성
3
if
≪

≪⊕
보조 비밀키  생성
4
if
≪

≪⊕

Part2: 검증대상 암호알고리즘 구현안내서
51
① 비밀키 길이 확인
블록암호별 지원 가능한 키 길이 확인
– ARIA, LEA, AES의 비밀키 길이: 128/192/256 비트
– SEED, HIGHT의 비밀키 길이: 128 비트
② 메시지인증코드 길이 확인
블록암호별 MAC 길이 확인
– ARIA, SEED, LEA, AES의 MAC 길이: ≤≤ 비트
– HIGHT의 MAC 길이: 비트
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고
5
if


⌈⌉
6
if
⊕

⊕
7

8
for  from  to  do
9
      ⊕
10
end for
11

12
if
      출력

      출력

GVI
Part 2
Guide for 
Vendor 
 Implementations

5장 해시함수 기반 
메시지인증코드

암호모듈 구현안내서
54
범위
q 본 문서에서는 해시함수 기반 메시지인증코드(MAC)를 구현할 경우의 고려사항을 기술한다.
해시함수 기반 메시지인증코드
HMAC
SHA2-224/256/384/512
LSH-224/256/384/512
LSH-512_224/512_256
SHA3-224/256/384/512
관련표준
▸[KS X ISO/IEC 9797-2] 메시지 인증 코드 – 제2부: 전용 해시 함수를 이용한 메커니즘 (2024)
▸[TTAK.KO-12.0330-Part1] 해시 함수 기반 메시지 인증 코드 (HMAC) - 제1부: 일반 (2018)
▸[TTAK.KO-12.0330-Part2] 해시 함수 기반 메시지 인증 코드 (HMAC) - 제2부: 해시 함수 SHA-2 (2018)
▸[TTAK.KO-12.0330-Part3] 해시 함수 기반 메시지 인증 코드 (HMAC) - 제3부: 해시 함수 LSH (2018)
▸[TTAK.KO-12.0330-Part4] 해시 함수 기반 메시지 인증 코드 (HMAC) - 제4부: 해시 함수 SHA-3 (2019)
▸[ISO/IEC 9797-2] Message authentication codes (MACs) Part 2: Mechanisms using a dedicated
hash-function (2021)
해시함수 기반 메시지인증코드
1
2

Part2: 검증대상 암호알고리즘 구현안내서
55
기호
기 호
의 미

비트열 의 비트 길이

HMAC 연산에 사용되는 패딩값

HMAC 연산에 사용되는 패딩값

평문 메시지

HMAC 연산 시 사용되는 비밀키

해시함수의 출력값 크기(비트)

해시함수의 블록 크기(바이트)

메시지인증코드

메시지인증코드 길이(비트)

길이의 연속된  비트열 (Ex. , )
해시함수 기반 메시지인증코드
▸HMAC은 MAC의 한 종류로서 메시지와 비밀키를 해시함수의 입력으로 MAC값을 계산하는 방식이다.
MAC값을 계산하기 위한 해시함수는 검증대상으로 지정된 SHA-2, LSH, SHA-3를 사용할 수 있다.
▸HMAC에서 이용하는 비밀키 K의 길이는 (해시함수 출력 크기)보다 크거나 같아야 한다.
3
4

암호모듈 구현안내서
56
알고리즘 명세 및 구현 시 고려사항
가. MAC 생성
HMAC 공통 알고리즘(HMAC )
고려사항
입력
－ 평문 
－ 비밀키 
－ 메시지인증코드 길이 
－ 해시함수 종류 
①, ②, ③
출력
－ 길이가 인 메시지인증코드 
1
if≻


2

3
⊕   ( = 0x36 * )
4
⊕  ( = 0x5c * )
5
′ 

6
′′ 
′
7
″ 
① 메시지인증코드 길이
해시함수 별로 아래 범위가 아닌 메시지인증코드 길이 입력 시 오류를 반환하는지 확인
– SHA2-224, LSH-224/512_224, SHA3-224 : ≤≤ 비트
– SHA2-256, LSH-256/512_256, SHA3-256 : ≤≤ 비트
– SHA2-384, LSH-384, SHA3-384 : ≤≤ 비트
– SHA2-512, LSH-512, SHA3-512 : ≤≤ 비트
② 안전한 키 생성 및 사용
HMAC에 사용되는 키 는 “중요보안매개변수(SSP) 생성” 방법으로 생성되어야 함
(검증대상 난수발생기를 이용하여 생성하는 등 안전한 방법으로 생성)
HMAC에 사용되는 키 는 해시함수 별로 해시함수의 출력 길이 보다 크거나 같아야 한다.
③ 입력메시지 길이 확인
의 길이 이 다음 ≤(비트)의 범위에 속하는지 확인
5

Part2: 검증대상 암호알고리즘 구현안내서
57
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

GVI
Part 2
Guide for 
Vendor 
 Implementations

6장 블록암호 기반 난수발생기

암호모듈 구현안내서
60
범위
q 본문서에서는ISO/IEC18031에명시된난수발생기중블록암호기반난수발생기(CTR_DRBG)를구현할경우의고려사항을
기술한다.
구분
적용 알고리즘
키 길이
CTR_DRBG
ARIA, LEA, AES
128/192/256
SEED, HIGHT
128
관련표준
▸[KS X ISO/IEC 18031] 난수발생기 (2023)
▸[TTAK.KO-12.0189/R2] 결정론적 난수 발생기 -제1부- 블록 암호 기반 난수 발생기 (2022)
▸[ISO/IEC 18031] Random bit generation (2025)
기호
블록암호 기반 난수발생기
기 호
의 미

비트열 의 비트 길이
_sec_
블록암호 알고리즘의 보안강도

블록암호 알고리즘이 한 번의 연산으로 처리할 수 있는 1블록의 길이 (비트)

블록암호 알고리즘의 키 길이 (비트)

DRBG 내부 메커니즘에 사용되는 의 비트 길이
()

카운터 필드의 비트 길이
⌈⌉
보다 크거나 같은 정수 중에서 최소값
∈
집합 의 원소 중 조건 를 만족하는 최소값
_
보안강도  이상을 갖는 임의 길이의 비트열을 잡음원으로부터 수집하는 함수

DRBG 초기화 단계에서 사용되는 논스
_
리씨드가 요구됨을 나타내는 상태값

Empty String

길이의 연속된  비트열 (Ex. , )

길이의 연속된  비트열 (Ex. , )

음이 아닌 정수 의 비트 이진수 표현

와  중에서 작은 값
1
2
3

Part2: 검증대상 암호알고리즘 구현안내서
61
블록암호 기반 난수발생기
▸CTR_DRBG는CTR모드(Countermode)로동작하는블록암호알고리즘을사용하는DRBG이다.CTR_DRBG의
초기화 함수, 리씨드 및 난수 생성 함수에 블록암호가 사용된다. CTR_DRBG는 초기화와 리씨드 함수에서
유도함수를 사용하는 경우와 유도함수를 사용하지 않는 경우의 2가지 형태로 구현될 수 있다. CTR_DRBG의
최대 안전성은 사용된 블록암호와 키 길이의 안전성에 의존한다.
q 난수발생기의 기본적인 구성요소는 다음과 같다.
구성요소
의 미
엔트로피 입력
(Entropy Input)
난수발생기에 (평가된 엔트로피에 해당하는) 예측 불가능성을 제공하기 위해 입력되는 비트열
인스턴스 초기화
(Instantiation)
논리적으로 독립적인 새로운 난수발생기 인스턴스를 초기 설정하는 과정
리씨드
(Reseed)
난수발생기 내부 상태에 영향을 미치는 새로운 정보(엔트로피 및 추가 입력값)을 획득하여 새로운
내부 상태로 갱신하는 과정
생성
(Generation)
인스턴스 초기화 또는 리씨드 후 수행하며, 요청된 의사난수 비트열을 생성하는 과정
내부 상태
(Internal State)
난수발생기 동작 시 필요에 의해 관리되는 모든 정보의 집합
보안강도 및 플래그와 같은 정책적인 데이터와 난수생성 시 사용되는 상태값 등 운영 데이터로
구성되며, 비밀 정보와 비밀이 아닌 정보가 모두 포함될 수 있음
q 다음 요소들은 선택적인 요소이다.
구성요소
의 미
추가 입력
(Additional Input)
선택적으로 사용되는 입력값으로, 리씨드 및 생성 과정에서 활용
개별화 문자열
(Personalization String)
선택적으로 사용되는 입력값으로, 인스턴스 초기화 과정에서 개별화 정보를 제공하기 위해 사용됨
장치일련번호, 사용자 및 응용프로그램 ID 등이 사용될 수 있음
논스
(Nonce)
인스턴스 초기화 과정에 사용되는 반복되지 않는 가변적인 값으로 난수발생기 구현 방법에 따라
적용여부가 결정됨
 예) 타임스탬프, 일련번호 또는 이들의 조합
기 호
의 미

비밀키 를 이용하여 입력값 를 암호화하는 블록암호 암호화 함수

주어진 비트열 의 상위(왼쪽) 개 비트열

주어진 비트열 의 하위(오른쪽) 개 비트열

비트열 의 하위 비트를 1만큼 증가시키는 함수 (상위 비트는 고정)
 ※ mod 
4

암호모듈 구현안내서
62
알고리즘 명세 및 구현 시 고려사항
가. 난수발생기 일반
□ DRBG 난수 생성 과정
5

Part2: 검증대상 암호알고리즘 구현안내서
63
□ 인스턴스 초기화 단계
DRBG 인스턴스 초기화(Instantiation)
고려사항
입력
－ 요구 보안강도 
－ 예측내성 지원 여부  ( 또는 )
－ 개별화 문자열 
①
출력
－ 내부 상태 또는 식별값 
1
if_sec_
     Error 출력
①
2
if && (구현물이 예측내성을 지원하지 않는 경우)
     Error 출력
3
∈≥
4
_
②
5
if(유도함수 사용 시),  생성
③
6
___
7
_or _
8
 출력

암호모듈 구현안내서
64
① 입력값 확인
요구 보안강도  : 사용되는 블록암호 알고리즘의 보안강도보다 작거나 같아야 함
개별화 문자열 길이 확인
– 유도함수 사용 시 : ≤≤ 비트
– 유도함수 미사용 시 : ≤≤ 비트 ()
② 엔트로피 수집 유효성 확인
엔트로피 수집함수가 건전성 테스트를 통과한 잡음원을 수집하는지 확인
수집된 엔트로피의 길이 및 보안강도 확인
– 유도함수 사용 시 : ≤ 비트
– 유도함수 미사용 시 :  비트 ()
– 의 엔트로피가  이상이어야 함
※ 유도함수 미사용 시, 은 Full-entropy를 가져야 함
③ 논스 생성 확인
논스는 초기화 연산의 각 실행에 대해 유일해야 하며, 비밀값일 필요는 없음
– 사용된 논스 값은 CSP로 관리되어야 함
생성된 논스 길이 확인
–  ≥ ()

[공통] 작동상태 관리 및 제로화 수행
각 난수발생기 인스턴스는 독립적인 내부상태를 가져야 함
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

Part2: 검증대상 암호알고리즘 구현안내서
65
□ 리씨드 단계
DRBG 리씨드(Reseed)
고려사항
입력
－ 내부 상태 또는 식별값 
－ 추가 입력 
①
출력
－ (갱신된) 내부 상태 또는 식별값 
1
입력된  유효성 확인
2
_
②
3
__
4
or 
5
 출력
① 입력값 확인
추가 입력 길이 확인
– 유도함수 사용 시 : ≤≤ 비트
– 유도함수 미사용 시 : ≤≤ 비트 ()
② 엔트로피 수집 유효성 확인
엔트로피 수집함수가 건전성 테스트를 통과한 잡음원을 수집하는지 확인
수집된 엔트로피의 길이 및 보안강도 확인
– 유도함수 사용 시 : ≤ 비트
– 유도함수 미사용 시 :  비트 ()
– 의 엔트로피가  이상이어야 함
※ 유도함수 미사용 시, 은 Full-entropy를 가져야 함
[공통] 작동상태 관리 및 제로화 수행
각 난수발생기 인스턴스는 독립적인 내부상태를 유지해야 함
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

암호모듈 구현안내서
66
□ 생성 단계
DRBG 생성(Generation)
고려사항
입력
－ 내부 상태 또는 식별값 
－ 예측내성 요청 여부  ( 또는 )
－ 추가 입력 
－ 난수 출력 요청 길이 
①
출력
－ (갱신된) 내부 상태 또는 식별값 
－ 생성된 난수 비트열 
1
입력된  유효성 확인
2
if(구현물이 예측내성을 지원하지 않는 경우) && if
     Error 출력
3
__
4
if__ 또는 if
     
     
     __
5
__
6
if_
     __
     단계 4로 이동
7
or 
8
 및  출력
 

Part2: 검증대상 암호알고리즘 구현안내서
67
① 입력값 확인
추가 입력 길이 확인
– 유도함수 사용 시 : ≤≤ 비트
– 유도함수 미사용 시 : ≤≤ 비트 ()
난수 출력 요청 길이 확인 (카운터 필드 길이  : ≤≤ 비트)
– ≤×  비트
  · ARIA, SEED, LEA, AES : 
  · HIGHT : 
[공통] 작동상태 관리 및 제로화 수행
각 난수발생기 인스턴스는 독립적인 내부상태를 유지해야 함
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

암호모듈 구현안내서
68
나. CTR-DRBG
■ CTR-DRBG 내부 블록암호 알고리즘별 주요 특징 (길이 단위 : 비트)
구분
ARIA/LEA/AES
-128
ARIA/LEA/AES
-192
ARIA/LEA/AES
-256
SEED
HIGHT
보안강도
(_sec_)





블록 길이 ()


키 길이 ()





카운터 필드 길이
()
≤≤
시드 길이
()





난수 생성 최대 요청 길이
(× )


리씨드 주기
(_)


유도함수 사용 시
엔트로피 입력 최소 길이

엔트로피 입력 최대 길이

개별화문자열 최대 길이

추가입력 최대 길이

유도함수 미사용 시
엔트로피 입력 최소 길이

엔트로피 입력 최대 길이

개별화문자열 최대 길이

추가입력 최대 길이


Part2: 검증대상 암호알고리즘 구현안내서
69
□ 초기화 함수 (__)
■ 유도함수 를 사용하는 경우
■ 유도함수를 사용하지 않는 경우

암호모듈 구현안내서
70
CTR-DRBG 초기화 함수(CTR_DRBG_Instantiate)
고려사항
입력
－ 엔트로피 입력 
－ (유도함수 사용 시) 논스 
－ 개별화 문자열 
－ 보안강도 
①
출력
－ 내부 상태 또는 식별값 
유도함수를 사용하는 경우
1

2

②
3
 -
유도함수를 사용하지 않는 경우
1

2
if

3
⊕
4

5

6

7

8
(, , )가 포함된  출력
① 입력된 보안강도() 이상의 안전성을 갖는 블록암호 알고리즘을 사용하는지 확인
② 블록암호 알고리즘별 설정되는 시드 길이 확인
– ARIA-128, LEA-128, AES-128, SEED : 256 비트
– ARIA-192, LEA-192, AES-192 : 320 비트
– ARIA-256, LEA-256, AES-256 : 384 비트
– HIGHT : 192 비트
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

Part2: 검증대상 암호알고리즘 구현안내서
71
□ 업데이트 함수 ()
업데이트 함수(Update)
고려사항
입력
－ 입력 비트열 
－ 난수발생기 상태값 
－ 난수발생기 상태값 
출력
－ (갱신된) 난수발생기 상태값 
－ (갱신된) 난수발생기 상태값 
1

2

3
      if
            mod 
            
4
      
            mod 
5
      
6
      
7

8
⊕
9

10

11
(, ) 출력
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

암호모듈 구현안내서
72
□ 유도함수 ()
BCC 함수(BCC)
고려사항
입력
－ 키 
－ 입력 비트열 
출력
－ 출력 비트열 
1

2

3

4
for  from  to  do
5
      ⊕
      
6
end for
7

8
 출력

Part2: 검증대상 암호알고리즘 구현안내서
73
CTR-DRBG 유도함수(DF)
고려사항
입력
－ 입력 비트열 
－ 요청 길이(비트) 
출력
－ 출력 비트열 
1

2

3

4
mod ≠
      
5

6

7
0x00010203 ... 1D1E1F
8

      
      
      
9

10

11

12

      
      
13

14
 출력
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

암호모듈 구현안내서
74
□ 리씨드 함수 (__)
■ 유도함수 를 사용하는 경우
■ 유도함수를 사용하지 않는 경우

Part2: 검증대상 암호알고리즘 구현안내서
75
CTR-DRBG 리씨드 함수(CTR_DRBG_Reseed)
고려사항
입력
－ 내부 상태 또는 식별값 
－ 엔트로피 입력 
－ 추가 입력 
출력
－ (갱신된) 내부 상태 또는 식별값 
유도함수를 사용하는 경우
1

2

①
3
 -
유도함수를 사용하지 않는 경우
1

2
if

3
⊕
4

5

6
(, , )가 포함된  출력
① 블록암호 알고리즘별 설정되는 시드 길이 확인
– ARIA-128, LEA-128, AES-128, SEED : 256 비트
– ARIA-192, LEA-192, AES-192 : 320 비트
– ARIA-256, LEA-256, AES-256 : 384 비트
– HIGHT : 192 비트
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

암호모듈 구현안내서
76
□ 생성 함수 (__)
■ 유도함수 를 사용하는 경우
■ 유도함수를 사용하지 않는 경우

Part2: 검증대상 암호알고리즘 구현안내서
77
CTR-DRBG 생성 함수(CTR_DRBG_Generate)
고려사항
입력
－ 내부 상태 또는 식별값 
－ 추가 입력 
－ 난수 출력 요청 길이(비트) 
출력
－ 동작 반환값 
－ 생성된 난수 비트열 
－ (갱신된) 내부 상태 또는 식별값 
1
if_
      = _
      출력
①
유도함수를 사용하는 경우
②
2
if≠
      
      
3

      
4
 -
5
 -
유도함수를 사용하지 않는 경우
②
2
if≠
      
3
      if
            
4
      
5

      
6

7

8
      if
            mod 
            
9
      
            mod 
10
      
11
      
12

13

14

15

16
, , (, , )가 포함된  출력

암호모듈 구현안내서
78
① 리씨드 주기 확인
– ARIA, SEED, LEA, AES : _≤
– HIGHT : _≤
② 블록암호 알고리즘별 설정되는 시드 길이 확인
– ARIA-128, LEA-128, AES-128, SEED : 256 비트
– ARIA-192, LEA-192, AES-192 : 320 비트
– ARIA-256, LEA-256, AES-256 : 384 비트
– HIGHT : 192 비트
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

5.1 내용추가 예정
7장 해시함수 기반 난수발생기

암호모듈 구현안내서
80
범위
q 본 문서에서는 ISO/IEC 18031에 명시된 난수발생기 중 Hash_DRBG와 HMAC_DRBG의 구현 시 고려사항을
기술한다.
구분
적용 알고리즘
Hash_DRBG
-
SHA2-224/256/384/512
LSH-224/256/384/512
LSH-512_224/512_256
SHA3-224/256/384/512
HMAC_DRBG
HMAC
SHA2-224/256/384/512
LSH-224/256/384/512
LSH-512_224/512_256
SHA3-224/256/384/512
관련표준
▸[KS X ISO/IEC 18031] 난수발생기 (2023)
▸[TTAK.KO-12.0331-Part1/R1] 해시 함수 기반 결정론적 난수발생기 - 제1부: 일반 (2022)
▸[TTAK.KO-12.0332-Part1/R1] HMAC 기반 결정론적 난수발생기 - 제1부: 일반 (2022)
▸[ISO/IEC 18031] Information technology - Security techniques - Random bit generation (2025)
기호
해시함수 기반 난수발생기
기 호
의 미

비트열 의 비트 길이
_sec_
해시함수 또는 HMAC 알고리즘의 보안강도

해시함수의 출력 해시값 또는 HMAC 알고리즘의 출력 MAC값 길이

DRBG 내부 메커니즘에 사용되는 의 비트 길이
⌈⌉
보다 크거나 같은 정수 중에서 최소값
∈
집합 의 원소 중 조건 를 만족하는 최소값
_
보안강도 A 이상을 갖는 임의 길이의 비트열을 잡음원으로부터 수집하는 함수

DRBG 초기화 단계에서 사용되는 논스
_
리씨드가 요구됨을 나타내는 상태값

Empty String

길이의 연속된  비트열 (Ex. , )
1
2
3

Part2: 검증대상 암호알고리즘 구현안내서
81
해시함수 기반 난수발생기
▸해시 기반 난수발생기(Hash_DRBG 및 HMAC_DRBG)는 초기화 함수, 리씨드 및 난수 생성 함수에 해시함수
또는 HMAC 알고리즘을 사용하는 난수발생기이다.
▸Hash_DRBG 및 HMAC_DRBG의 최대 안전성은 사용된 해시함수의 안전성에 의존한다.
q 난수발생기의 기본적인 구성요소는 다음과 같다.
구성요소
의 미
엔트로피 입력
(Entropy Input)
난수발생기에 (평가된 엔트로피에 해당하는) 예측 불가능성을 제공하기 위해 입력되는 비트열
인스턴스 초기화
(Instantiation)
논리적으로 독립적인 새로운 난수발생기 인스턴스를 초기 설정하는 과정
리씨드
(Reseed)
난수발생기 내부 상태에 영향을 미치는 새로운 정보(엔트로피 및 추가 입력값)을 획득하여 새로운
내부 상태로 갱신하는 과정
생성
(Generation)
인스턴스 초기화 또는 리씨드 후 수행하며, 요청된 의사난수 비트열을 생성하는 과정
내부 상태
(Internal State)
난수발생기 동작 시 필요에 의해 관리되는 모든 정보의 집합
보안강도 및 플래그와 같은 정책적인 데이터와 난수생성 시 사용되는 상태값 등 운영 데이터로
구성되며, 비밀 정보와 비밀이 아닌 정보가 모두 포함될 수 있음
q 다음 요소들은 선택적인 요소이다.
구성요소
의 미
추가 입력
(Additional Input)
선택적으로 사용되는 입력값으로, 리씨드 및 생성 과정에서 활용
개별화 문자열
(Personalization String)
선택적으로 사용되는 입력값으로, 인스턴스 초기화 과정에서 개별화 정보를 제공하기 위해 사용됨
장치일련번호, 사용자 및 응용프로그램 ID 등이 사용될 수 있음
논스
(Nonce)
인스턴스 초기화 과정에 사용되는 반복되지 않는 가변적인 값으로 난수발생기 구현 방법에 따라
적용여부가 결정됨
 예) 타임스탬프, 일련번호 또는 이들의 조합
기 호
의 미

길이의 연속된  비트열 (Ex. , )

음이 아닌 정수 의 비트 이진수 표현

와  중에서 작은 값

입력값 에 대한 해시함수 출력 해시값

입력값 에 대하여 비밀키 를 이용한 HMAC 연산 출력 MAC값

주어진 비트열 의 상위(왼쪽) 개 비트열

주어진 비트열 의 하위(오른쪽) 개 비트열
4

암호모듈 구현안내서
82
알고리즘 명세 및 구현 시 고려사항
가. 난수발생기 일반
□ DRBG 난수 생성 과정
5

Part2: 검증대상 암호알고리즘 구현안내서
83
□ 인스턴스 초기화 단계
DRBG 인스턴스 초기화(Instantiation)
고려사항
입력
－ 요구 보안강도 
－ 예측내성 지원 여부  ( 또는 )
－ 개별화 문자열 
①
출력
－ 내부 상태 또는 식별값 
1
∈≥
①
2
if___sec_
     Error 출력
①
3
if && (구현물이 예측내성을 지원하지 않는 경우)
     Error 출력
4
_
②
5
 생성
③
6
__
7
_or _
8
 출력

암호모듈 구현안내서
84
① 입력값 확인
요구 보안강도  : 사용되는 해시함수 기반 알고리즘의 보안강도보다 작거나 같아야 함
개별화 문자열 길이 확인
– ≤≤ 비트
② 엔트로피 수집 유효성 확인
엔트로피 수집함수가 건전성 테스트를 통과한 잡음원을 수집하는지 확인
수집된 엔트로피의 길이 및 보안강도 확인
– ≤ 비트
– 의 엔트로피가  이상이어야 함
③ 논스 생성 확인
논스는 초기화 연산의 각 실행에 대해 유일해야 하며, 비밀값일 필요는 없음
– 사용된 논스 값은 CSP로 관리되어야 함
생성된 논스 길이 확인
–  ≥ ()
[공통] 작동상태 관리 및 제로화 수행
각 난수발생기 인스턴스는 독립적인 내부상태를 가져야 함
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

Part2: 검증대상 암호알고리즘 구현안내서
85
□ 리씨드 단계
DRBG 리씨드(Reseed)
고려사항
입력
－ 내부 상태 또는 식별값 
－ 추가 입력 
①
출력
－ (갱신된) 내부 상태 또는 식별값 
1
입력된  유효성 확인
2
_
②
3
_
4
or 
5
 출력
① 입력값 확인
추가 입력 길이 확인
– ≤≤ 비트
② 엔트로피 수집 유효성 확인
엔트로피 수집함수가 건전성 테스트를 통과한 잡음원을 수집하는지 확인
수집된 엔트로피의 길이 및 보안강도 확인
– ≤ 비트
– 의 엔트로피가  이상이어야 함
[공통] 작동상태 관리 및 제로화 수행
각 난수발생기 인스턴스는 독립적인 내부상태를 유지해야 함
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

암호모듈 구현안내서
86
□ 생성 단계
DRBG 생성(Generation)
고려사항
입력
－ 내부 상태 또는 식별값 
－ 예측내성 요청 여부  ( 또는 )
－ 추가 입력 
－ 난수 출력 요청 길이(비트) 
①
출력
－ (갱신된) 내부 상태 또는 식별값 
－ 생성된 난수 비트열 
1
입력된  유효성 확인
2
if(구현물이 예측내성을 지원하지 않는 경우) && if
     Error 출력
3
__
4
if__ 또는 if
     
     
     __
5
_
6
if_
     __
     단계 4로 이동
7
or 
8
 및  출력

Part2: 검증대상 암호알고리즘 구현안내서
87
① 입력값 확인
추가 입력 길이 확인
– ≤≤ 비트
난수 출력 요청 길이 확인
– ≤ 비트
[공통] 작동상태 관리 및 제로화 수행
각 난수발생기 인스턴스는 독립적인 내부상태를 유지해야 함
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

암호모듈 구현안내서
88
■ Hash-DRBG 및 HMAC-DRBG 내부 해시함수(SHA-2)별 주요 특징 (길이 단위 : 비트)
구분
224 Series
256 Series
384 Series
512 Series
보안강도
(_sec_)




출력 길이 ()




시드 길이
()


엔트로피 입력 최소 길이

엔트로피 입력 최대 길이

개별화문자열 최대 길이

추가입력 최대 길이

난수 생성 최대 요청 길이

리씨드 주기
(_)

■ Hash-DRBG 및 HMAC-DRBG 내부 해시함수(LSH, SHA-3)별 주요 특징 (길이 단위 : 비트)
구분
224 Series
256 Series
384 Series
512 Series
보안강도
(_sec_)




출력 길이 ()




시드 길이
()


엔트로피 입력 최소 길이

엔트로피 입력 최대 길이

개별화문자열 최대 길이

추가입력 최대 길이

난수 생성 최대 요청 길이

리씨드 주기
(_)


Part2: 검증대상 암호알고리즘 구현안내서
89
나. Hash-DRBG
□ 초기화 함수 (_)
Hash-DRBG 초기화 함수(DRBG_Instantiate)
고려사항
입력
－ 엔트로피 입력 
－ 논스 
－ 개별화 문자열 
－ 보안강도 
①
출력
－ 내부 상태 또는 식별값 
1

2

②
3

4

②
5

6
(, , )가 포함된  출력

① 입력된 보안강도() 이상의 안전성을 갖는 해시함수를 사용하는지 확인

② 해시함수별 설정되는 시드 길이 확인
– SHA2-224, LSH-224/512_224, SHA3-224 :  비트
– SHA2-256, LSH-256/512_256, SHA3-256 :  비트
– SHA2-384, LSH-384, SHA3-384 :  비트
– SHA2-512, LSH-512, SHA3-512 :  비트

암호모듈 구현안내서
90
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고
□ 유도함수 ()
Hash-DRBG 유도함수(DF)
고려사항
입력
－ 입력 비트열 
－ 요청 길이(비트) 
출력
－ 출력 비트열 
1

2
⌈

⌉
3

4
for  from  to  do
5
      
      
6
end for
7

8
 출력
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

Part2: 검증대상 암호알고리즘 구현안내서
91
□ 리씨드 함수 (_)
Hash-DRBG 리씨드 함수(DRBG_Reseed)
고려사항
입력
－ 내부 상태 또는 식별값 
－ 엔트로피 입력 
－ 추가 입력 
출력
－ (갱신된) 내부 상태 또는 식별값 
1

2

①
3

4

①
5

6
(, , )가 포함된  출력
① 해시함수별 설정되는 시드 길이 확인
– SHA2-224, LSH-224/512_224, SHA3-224 :  비트
– SHA2-256, LSH-256/512_256, SHA3-256 :  비트
– SHA2-384, LSH-384, SHA3-384 :  비트
– SHA2-512, LSH-512, SHA3-512 :  비트
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

암호모듈 구현안내서
92
□ 생성 함수 (_)
Hashgen 함수(Hashgen)
고려사항
입력
－ 요청 길이 
－ 입력 비트열 
출력
－ 출력 비트열 
1
⌈

⌉
2

3

4
for  from  to  do
5
      
      
      mod 
6
end for
7

8
 출력

Part2: 검증대상 암호알고리즘 구현안내서
93
Hash-DRBG 생성 함수(DRBG_Generate)
고려사항
입력
－ 내부 상태 또는 식별값 
－ 추가 입력 
－ 난수 출력 요청 길이(비트) 
출력
－ 동작 반환값 
－ 생성된 난수 비트열 
－ (갱신된) 내부 상태 또는 식별값 
1
if_
      = _
      출력
①
2
if≠
      
      mod 
②
3

4

5
mod 
②
6

7

8
, , (, , )가 포함된  출력
① 리씨드 주기 확인
_≤
② 해시함수별 설정되는 시드 길이 확인
– SHA2-224, LSH-224/512_224, SHA3-224 :  비트
– SHA2-256, LSH-256/512_256, SHA3-256 :  비트
– SHA2-384, LSH-384, SHA3-384 :  비트
– SHA2-512, LSH-512, SHA3-512 :  비트
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

암호모듈 구현안내서
94
다. HMAC-DRBG
□ 초기화 함수 (_)
HMAC-DRBG 초기화 함수(DRBG_Instantiate)
고려사항
입력
－ 엔트로피 입력 
－ 논스 
－ 개별화 문자열 
－ 보안강도 
①
출력
－ 내부 상태 또는 식별값 
1

2

3

4

5

6
(, , )가 포함된  출력
① 입력된 보안강도() 이상의 안전성을 갖는 HMAC 알고리즘을 사용하는지 확인
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

Part2: 검증대상 암호알고리즘 구현안내서
95
□ 업데이트 함수 ()
업데이트 함수(Update)
고려사항
입력
－ 입력 비트열 
－ 난수발생기 상태값 
－ 난수발생기 상태값 
출력
－ (갱신된) 난수발생기 상태값 
－ (갱신된) 난수발생기 상태값 
1

2

3
if
      (, ) 출력
4

5

6
(, ) 출력
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

암호모듈 구현안내서
96
□ 리씨드 함수 (_)
HMAC-DRBG 리씨드 함수(DRBG_Reseed)
고려사항
입력
－ 내부 상태 또는 식별값 
－ 엔트로피 입력 
－ 추가 입력 
출력
－ (갱신된) 내부 상태 또는 식별값 
1

2

3

4
(, , )가 포함된  출력
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

Part2: 검증대상 암호알고리즘 구현안내서
97
□ 생성 함수 (_)
HMAC-DRBG 생성 함수(DRBG_Generate)
고려사항
입력
－ 내부 상태 또는 식별값 
－ 추가 입력 
－ 난수 출력 요청 길이(비트) 
출력
－ 동작 반환값 
－ 생성된 난수 비트열 
－ (갱신된) 내부 상태 또는 식별값 
1
if_
      = _
      출력
①
2
if≠
      
3

4

      
      
5

6

7

8

9
, , (, , )가 포함된  출력

암호모듈 구현안내서
98
① 리씨드 주기 확인
_≤
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

8장 RSA 기반 공개키 암호

암호모듈 구현안내서
100
범위
q 본문서에서는ISO/IEC18033-2에기술된RSA기반공개키암호알고리즘(RSAES)을구현할경우의고려사항을기술
한다.
구분
파라미터
모듈러스()의 비트 크기
2048
3072
해시함수
SHA2-224
SHA2-256
관련표준
▸[KS X ISO/IEC 18033-2] 암호 알고리즘 – 제2부: 비대칭형 암호 (2022)
▸[ISO/IEC 18033-2] Encryption algorithms Part 2: Asymmetric ciphers (2017)
▸[RFC 8017] PKCS #1: RSA Cryptography Specifications Version 2.2 (2016)
기호
RSA 기반 공개키 암호
기 호
의 미

비트열 의 비트 길이

 비트 길이의 소수를 생성하는 함수

와 의 최소공배수 (Largest Common Multiple)

와 의 최대공약수 (Greatest Common Divisor)

의 절대값 (Absoulte value)

보다 크고 보다 작은 임의의 난수값을 생성하는 함수 ( 초과 ~  미만)

비트 길이의 난수 비트열을 생성하는 함수

Empty String
⌈⌉
보다 크거나 같은 정수 중에서 최소값

음이 아닌 정수 의 비트 이진수 표현

길이의 연속된  비트열 (Ex. , )
1
2
3

Part2: 검증대상 암호알고리즘 구현안내서
101
RSA 기반 공개키 암호
▸RSA 암호는 정수 소인수 분해 문제의 어려움에 그 안전성의 기초를 두고 있다.
▸RSA의 안전성에 영향을 끼치는 요소로는 모듈러스 의 크기, 비밀정보로 사용되는 소수 , 의 선택, 암호화
지수 의 크기, 복호화 지수 의 크기 등이 있다.
기 호
의 미

길이의 연속된  비트열 (Ex. , )

주어진 비트열 의 상위(왼쪽) 개 비트열

입력된 임의 길이의 메시지 에 대해 고정된 길이의 해시값을 출력하는 해시함수

비트열 를 양의 정수값으로 변환하는 함수

양의 정수값 을 길이의 비트열로 변환하는 함수

비트열 X의 MSB부터 시작하여 비트 가 첫 번째로 나타나는 위치값
(Ex. , )
4

암호모듈 구현안내서
102
알고리즘 명세 및 구현 시 고려사항
가. 키 생성
■ 모듈러스 : 비슷한 크기의 충분히 큰 서로 다른 소수 , 를 선택하고 × 를 생성한다.
■ 암호화 지수 : 을 만족하는 랜덤한 수 를 선택한다.
여기서 이다.
■ 복호화 지수 : × mod 를 만족하는 유일한 정수 를 선택한다.
키 생성 알고리즘(RSAKeyGen)
고려사항
입력
－ 모듈러스 의 비트 길이 
－ (Optional) 공개키 요소 
①
출력
－ 공개키 
－ 개인키 
1

②, ③
2
if
     단계 1로 이동
3

②, ③
4
if
     단계 3으로 이동
5
if≤
     단계 3으로 이동
6
× 
7

8

9
if
     
②
10
if≤≥mod 
     if then 단계 9로 이동
      then Error 출력
11
if
     if then 단계 9로 이동
      then 단계 1로 이동
12
mod 
13
if≤
     if then 단계 9로 이동
      then 단계 1로 이동
14
와  출력
5

Part2: 검증대상 암호알고리즘 구현안내서
103
① 검증대상 모듈러스 크기 확인
지원 가능한 모듈러스 크기 확인
– ∈ 비트
② 검증대상 난수발생기 사용 확인
난수를 생성하는 경우, 검증대상 난수발생기를 사용해야 함
③ 소수 생성방법 및 Miller-Rabin 소수 판정법 반복 횟수 확인
– 소수 생성방법은 암호모듈 구현안내서(GVI Part 1) 9.1 참조
– 소수 판정법으로는 Miller-Rabin 소수 판정법만이 허용되며 반복 횟수는 아래와 같음
  ·  비트인 경우: 최소 56회 수행 (오류 확률: )
  ·  비트인 경우: 최소 64회 수행 (오류 확률: )
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

암호모듈 구현안내서
104
나. RSA-OAEP 암호화
■ RSA-OAEP 암호화는 메시지 인코딩 과정과 RSA 암호화 과정으로 구성된다.
■ 메시지 인코딩 과정에서는 메시지 과 라벨 값을 이용하여 인코딩된 메시지 를 구한다.
_
■ RSA 암호화 과정에서는 인코딩된 메시지 에 대해서 공개키 를 이용하여 암호문 를 계산한다.
mod 
□ 메시지 인코딩 (_)

Part2: 검증대상 암호알고리즘 구현안내서
105
인코딩 알고리즘(OAEP_Encode)
고려사항
설정
－  : 모듈러스 의 비트 길이
－  : 내부 해시함수 (출력 길이 :  비트)
①, ②
입력
－ 메시지 
－ (Optional) 레이블 
출력
－ 인코딩된 메시지 
1

2
× 
3

4

③
5

6
⊕
7

8
⊕
9

10
인코딩된 메시지  출력
Mask 생성 함수(MGF)
고려사항
설정
－  : 내부 해시함수 (출력 길이 :  비트)
②
입력
－ 씨드값 
－ 생성할 마스킹 값의 길이(비트) 
출력
－ 마스킹 결과값 
1

2
for  from  to ⌈⌉ do
3
      
      
4
end for
5

6
 출력

암호모듈 구현안내서
106
① 검증대상 모듈러스 크기 확인
지원 가능한 모듈러스 크기 확인
– ∈ 비트
② 검증대상 해시함수 사용 확인
내부 해시함수로 검증대상 해시함수를 사용해야 함
– SHA2-224, SHA2-256만 허용됨
③ 검증대상 난수발생기 사용 확인
 생성 시, 검증대상 난수발생기를 사용해야 함
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고
□ RSA-OAEP 암호화 (__)
RSA 암호화(RSA_OAEP_Encrypt)
고려사항
입력
－ RSA 공개키 
－ 메시지 
－ (Optional) 레이블 
①, ②, ③
출력
－ 암호문 
1
_
2

3
mod 
4

5
암호문  출력
① 검증대상 모듈러스 크기 확인
지원 가능한 모듈러스 크기 확인
– ∈ 비트


Part2: 검증대상 암호알고리즘 구현안내서
107
② 메시지 길이 확인
메시지 최대 길이 확인 : ≤× 
1) , SHA2-224를 사용하는 경우 : ≤ 비트
2) , SHA2-256을 사용하는 경우 : ≤ 비트
3) , SHA2-256을 사용하는 경우 : ≤ 비트
③ 레이블  길이 확인
레이블 은 해시함수의 입력 메시지 길이 조건을 충족해야 함
– SHA2-224, SHA2-256 : ≤ 비트
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

암호모듈 구현안내서
108
다. RSA-OAEP 복호화
■ RSA-OAEP 복호화는 RSA 복호화 과정과 메시지 디코딩 과정으로 구성된다.
■ RSA 복호화 과정에서는 암호문 와 개인키 를 이용하여 인코딩된 메시지 을 계산한다.
mod 
■ 메시지 디코딩 과정에서는 인코딩된 메시지 과 라벨 값을 이용하여 메시지 을 구한다.
_
□ 메시지 디코딩 (_)

Part2: 검증대상 암호알고리즘 구현안내서
109
디코딩 알고리즘(OAEP_Decode)
고려사항
설정
－  : 모듈러스 의 비트 길이
－  : 내부 해시함수 (출력 길이 :  비트)
①, ②
입력
－ 인코딩된 메시지 
－ (Optional) 레이블 
출력
－ 메시지 
1

2
다음과 같이 EM을 분리
 
     ()
3
if
     Error 출력
4

5
⊕
6

7
⊕
8

9

10

11

12

13
if′′
     Error 출력
14

15
if× 
     Error 출력
16
메시지  출력
① 검증대상 모듈러스 크기 확인
지원 가능한 모듈러스 크기 확인
– ∈ 비트
② 검증대상 해시함수 사용 확인
내부 해시함수로 검증대상 해시함수를 사용해야 함
– SHA2-224, SHA2-256만 허용됨
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

암호모듈 구현안내서
110
□ RSA-OAEP 복호화 (__)
RSA 복호화(RSA_OAEP_Decrypt)
고려사항
입력
－ RSA 개인키 
－ 암호문 
－ (Optional) 레이블 
①, ②, ③
출력
－ 메시지 
1

2
mod 
3

4
_
5
_ 과정에서 Error가 발생하는 경우
     Error 출력
6
메시지  출력
① 검증대상 모듈러스 크기 확인
지원 가능한 모듈러스 크기 확인
– ∈ 비트
② 암호문  길이 확인
≤
③ 레이블  길이 확인
레이블 은 해시함수의 입력 메시지 길이 조건을 충족해야 함
– SHA2-224, SHA2-256 : ≤ 비트
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

9장 RSA 기반 전자서명

암호모듈 구현안내서
112
범위
q 본문서에서는ISO/IEC14888-2에기술된RSA기반전자서명알고리즘(RSASSA-PSS)를구현할경우의고려사항
을 기술한다.
구분
파라미터
모듈러스()의 비트 크기
2048
3072
해시함수
SHA2-224
SHA2-256
관련표준
▸[KS X ISO/IEC 14888-2] 부가형 디지털 서명 – 제2부: 정수 인수분해 기반 메커니즘 (2021)
▸[ISO/IEC 14888-2] Digital signatures with appendix Part 2: Integer factorization based
mechanisms (2015)
▸[FIPS 186-5] Digital Signature Standard (DSS) (2023)
▸[RFC 8017] PKCS #1: RSA Cryptography Specifications Version 2.2 (2016)
기호
RSA 기반 전자서명
기 호
의 미

비트열 의 비트 길이

 비트 길이의 소수를 생성하는 함수

와 의 최소공배수 (Largest Common Multiple)

와 의 최대공약수 (Greatest Common Divisor)

의 절대값 (Absoulte value)

보다 크고 보다 작은 임의의 난수값을 생성하는 함수 ( 초과 ~  미만)

비트 길이의 난수 비트열을 생성하는 함수

Empty String
⌈⌉
보다 크거나 같은 정수 중에서 최소값

음이 아닌 정수 의 비트 이진수 표현
1
2
3

Part2: 검증대상 암호알고리즘 구현안내서
113
RSA 기반 전자서명
▸RSA 암호는 정수 소인수 분해 문제의 어려움에 그 안전성의 기초를 두고 있다.
▸RSA의안전성에영향을끼치는요소로는모듈러스 의크기,비밀정보로사용되는소수 , 의선택,서명생성
지수 의 크기, 서명 검증 지수 의 크기 등이 있다.
▸RSA 기반 전자서명 단계는 키 생성, 전자서명 생성, 전자서명 검증으로 구분된다.
기 호
의 미

길이의 연속된  비트열 (Ex. , )

길이의 연속된  비트열 (Ex. , )

주어진 비트열 의 상위(왼쪽) 개 비트열

주어진 비트열 의 하위(오른쪽) 개 비트열

입력된 임의 길이의 메시지 에 대해 고정된 길이의 해시값을 출력하는 해시함수

비트열 를 양의 정수값으로 변환하는 함수

양의 정수값 을 길이의 비트열로 변환하는 함수

비트열 X의 MSB부터 시작하여 비트 가 첫 번째로 나타나는 위치값
(Ex. , )
4

암호모듈 구현안내서
114
알고리즘 명세 및 구현 시 고려사항
가. 키 생성
■ 모듈러스 : 비슷한 크기의 충분히 큰 서로 다른 소수 , 를 선택하고 × 를 생성한다.
■ 암호화 지수 : 을 만족하는 랜덤한 수 를 선택한다.
여기서 이다.
■ 복호화 지수 : × mod 를 만족하는 유일한 정수 를 선택한다.
키 생성 알고리즘(RSAKeyGen)
고려사항
입력
－ 모듈러스 의 비트 길이 
－ (Optional) 공개키 요소 
①
출력
－ 공개키 
－ 개인키 
1

②, ③
2
if
     단계 1로 이동
3

②, ③
4
if
     단계 3으로 이동
5
if≤
     단계 3으로 이동
6
× 
7

8

9
if
     
②
10
if≤≥mod 
     if then 단계 9로 이동
      then Error 출력
11
if
     if then 단계 9로 이동
      then 단계 1로 이동
12
mod 
13
if≤
     if then 단계 9로 이동
      then 단계 1로 이동
14
와  출력
① 검증대상 모듈러스 크기 확인
지원 가능한 모듈러스 크기 확인
– ∈ 비트
5

Part2: 검증대상 암호알고리즘 구현안내서
115
② 검증대상 난수발생기 사용 확인
난수를 생성하는 경우, 검증대상 난수발생기를 사용해야 함
③ 소수 생성방법 및 Miller-Rabin 소수 판정법 반복 횟수 확인
– 소수 생성방법은 암호모듈 구현안내서(GVI Part 1) 9.1 참조
– 소수 판정법으로는 Miller-Rabin 소수 판정법만이 허용되며 반복 횟수는 아래와 같음
  ·  비트인 경우: 최소 56회 수행 (오류 확률: )
  ·  비트인 경우: 최소 64회 수행 (오류 확률: )
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

암호모듈 구현안내서
116
나. RSASSA-PSS 서명 생성
■ RSASSA-PSS 서명 생성은 메시지 인코딩 과정과 RSA 서명 과정으로 구성된다.
■ 메시지 인코딩 과정에서는 메시지 을 이용하여 인코딩된 메시지 를 구한다.
_
■ RSA 서명 과정에서는 인코딩된 메시지 에 대해서 개인키 를 이용하여 서명 를 계산한다.
mod 
□ 메시지 인코딩 (_)

Part2: 검증대상 암호알고리즘 구현안내서
117
인코딩 알고리즘(PSS_Encode)
고려사항
설정
－  : 모듈러스 의 비트 길이
－  : 내부 해시함수 (출력 길이 :  비트)
①, ②
입력
－ 메시지 
－ 내부에서 생성될 의 비트 길이 
출력
－ 인코딩된 메시지 
1

2
if
     Error 출력
3

③
4

5

6

7

8

9
⊕
10

11

12
인코딩된 메시지  출력
Mask 생성 함수(MGF)
고려사항
설정
－  : 내부 해시함수 (출력 길이 :  비트)
②
입력
－ 씨드값 
－ 생성할 마스킹 값의 길이(비트) 
출력
－ 마스킹 결과값 
1

2
for  from  to ⌈⌉ do
3
      
      
4
end for
5

6
 출력

암호모듈 구현안내서
118
① 검증대상 모듈러스 크기 확인
지원 가능한 모듈러스 크기 확인
– ∈ 비트
② 검증대상 해시함수 사용 확인
내부 해시함수로 검증대상 해시함수를 사용해야 함
– SHA2-224, SHA2-256만 허용됨
③ 검증대상 난수발생기 사용 확인
 생성 시, 검증대상 난수발생기를 사용해야 함
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고
□ RSASSA-PSS 서명 생성 (__)
RSA 서명 생성(RSA_PSS_Sign)
고려사항
입력
－ RSA 개인키 
－ 메시지 
①, ②
출력
－ 전자서명값 
1

③
2
_
3

4
mod 
5

6
전자서명값  출력
① 검증대상 모듈러스 크기 확인
지원 가능한 모듈러스 크기 확인
– ∈ 비트

Part2: 검증대상 암호알고리즘 구현안내서
119
② 메시지 길이 확인
메시지 은 해시함수의 입력 메시지 길이 조건을 충족해야 함
– SHA2-224, SHA2-256 : ≤ 비트
③  길이() 확인
의 길이는 해시함수 출력 길이 이상이어야 함
1) , SHA2-224를 사용하는 경우 : ≤≤ 비트
2) , SHA2-256을 사용하는 경우 : ≤≤ 비트
3) , SHA2-256을 사용하는 경우 : ≤≤ 비트
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

암호모듈 구현안내서
120
다. RSASSA-PSS 서명 검증
■ RSASSA-PSS 서명 검증은 RSA 검증변환 과정과 메시지 디코딩 및 검증 과정으로 구성된다.
■ RSA 검증변환 과정에서는 서명 와 공개키 를 이용하여 인코딩된 메시지 을 계산한다.
mod 
■ 메시지 디코딩 및 검증 과정에서는 인코딩된 메시지 과 메시지 값을 이용하여 서명 진위 여부를 판단한다.
_
□ 메시지 디코딩 (_)

Part2: 검증대상 암호알고리즘 구현안내서
121
디코딩 및 서명 검증 알고리즘(PSS_DecodeVerify)
고려사항
설정
－  : 모듈러스 의 비트 길이
－  : 내부 해시함수 (출력 길이 :  비트)
①, ②
입력
－ 인코딩된 메시지 
－ 메시지 
출력
－ 서명검증 결과  or 
1

2
if′′
      출력
3
다음과 같이 EM을 분리
 
     ()
4
if′′
      출력
5

6
⊕
7

8

9

10

11
if′′
      출력
12

13
if
      출력
14

15

16
if
      출력

      출력
① 검증대상 모듈러스 크기 확인
지원 가능한 모듈러스 크기 확인
– ∈ 비트

암호모듈 구현안내서
122
② 검증대상 해시함수 사용 확인
내부 해시함수로 검증대상 해시함수를 사용해야 함
– SHA2-224, SHA2-256만 허용됨
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고
□ RSASSA-PSS 서명 검증 (__)
RSA 서명 검증(RSA_PSS_Verify)
고려사항
입력
－ RSA 공개키 
－ 전자서명 
－ 메시지 
①, ②, ③
출력
－ 서명검증 결과  or 
1

2
mod 
3

4
_
5
 출력
① 검증대상 모듈러스 크기 확인
지원 가능한 모듈러스 크기 확인
– ∈ 비트
② 전자서명  길이 확인
≤
③ 메시지  길이 확인
메시지 은 해시함수의 입력 메시지 길이 조건을 충족해야 함
– SHA2-224, SHA2-256 : ≤ 비트
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

8.1 내용추가 예정
10장 이산대수 기반 전자서명

암호모듈 구현안내서
124
범위
q 본문서에서는ISO/IEC14888-3에기술된 이산대수기반전자서명알고리즘(KCDSA)를구현할경우의고려사항
을 기술한다.
도메인 변수 길이(비트)
해시함수
(, ) = (2048, 224)
SHA2-224/256
(, ) = (2048, 256)
SHA2-256
(, ) = (3072, 256)
관련표준
▸[KS X ISO/IEC 14888-3] 부가형 디지털 서명 - 제2부: 이산대수 기반 메커니즘 (2021)
▸[TTAK.KO-12.0001/R4] 부가형 전자 서명 방식 표준 - 제2부: 한국형 인증서 기반 전자서명 알고리즘
(KCDSA) (2016)
▸[ISO/IEC 14888-3] Digital signatures with appendix - Part 3: Discrete logarithm based
mechanisms (2018)
기호
이산대수 기반 전자서명
기 호
의 미

비트열 의 비트 길이

 비트 길이의 소수를 생성하는 함수

Miller-Rabin 소수 판정법을 이용하여 입력값 의 소수 여부를 판단하는 함수

보다 크고 보다 작은 임의의 난수값을 생성하는 함수 ( 초과 ~  미만)

비트 길이의 난수 비트열을 생성하는 함수

Empty String
⌊⌋
보다 작거나 같은 정수 중에서 최대값

음이 아닌 정수 의 비트 이진수 표현

길이의 연속된  비트열 (Ex. , )

길이의 연속된  비트열 (Ex. , )

주어진 비트열 의 하위(오른쪽) 개 비트열

입력된 임의 길이의 메시지 에 대해 고정된 길이의 해시값을 출력하는 해시함수

비트열 를 양의 정수값으로 변환하는 함수

양의 정수값 을 길이의 비트열로 변환하는 함수
1
2
3

Part2: 검증대상 암호알고리즘 구현안내서
125
이산대수 기반 전자서명
▸이산대수기반전자서명은이산대수문제의어려움에그안전성의기초를두고있으며,KCDSA는한국형인증서
기반부가형전자서명알고리즘1)으로서임의의길이를갖는메시지에대한전자서명을생성및검증할수있다.
▸KCDSA 전자서명 단계는 도메인 변수 및 키 생성, 전자서명 생성, 그리고 전자서명 검증으로 구분된다.
알고리즘 명세 및 구현 시 고려사항
가. 도메인 변수 및 키 생성
■ 도메인 변수 , 는 다음의 조건을 만족해야 한다.
  - : 의크기를가지는소수이며, 이소수이거나최소한 보다큰소수들의곱으로구성한
다. 본 문서는  가 소수인 경우를 다룬다.
  - : 을 나누는 소수이며, 의 크기를 가진다.
■ 생성원 는 다음의 조건을 만족해야 한다.
  - : 위수 인 부분군의 생성원이다. 즉, mod  (, )을 만족하는 정수를선택한
다.
■ 개인키(서명키) , 공개키(검증키) 는 다음을 만족해야 한다.
  - : 을 만족하는 랜덤한 정수 를 선택한다.
  - : mod 로 계산되는 유일한 정수를 선택한다.
□ 일방향 함수 PPGF를 이용한 도메인 변수 생성 방법
일방향 함수(PPGF)
고려사항
설정
－  : 내부 해시함수 (출력 길이 :  비트)
①
입력
－ 비트열 
－ 출력 길이(비트) 
출력
－ 길이 인 비트열 
1
⌊⌋
2
mod 
3

4
for  from  to  do
5
      
6
end for
7

1)부가형전자서명알고리즘(Digitalsignaturemechanismwithappendix)은전자문서의해시코드에공개키연산을적용하여전자서명을생성한다.검
증자는수신된메시지와전자서명을대상으로전자서명생성에사용된것과동일한해시함수와서명자의서명키에대응하는검증키를사용하여전자서명의
유효성을확인한다.
4
5

암호모듈 구현안내서
126
도메인 변수 생성 알고리즘(KCDSA_GenParam)
고려사항
입력
－ 소수 의 비트 길이 
－ 소수 의 비트 길이 
②
출력
－ 도메인 변수 , , 
－ 증거값 , , , 
1

③
2

3
∨
4

5
if
     단계 1로 이동
④
6

7

8
if
     단계 1로 이동
9

10
∨
11

12

13
if
     단계 7로 이동
14
if
     단계 7로 이동
④
15
if
     단계 7로 이동
④
16

③
17
mod 
18
if
     단계 16으로 이동
19
도메인 변수 , , 와 증거값 , , ,  출력
① 검증대상 해시함수 사용 확인
사용 가능한 해시함수 확인
– 인 경우, SHA2-224 및 SHA2-256 사용 가능
– 인 경우, SHA2-256 사용 가능

Part2: 검증대상 암호알고리즘 구현안내서
127
② 도메인 변수 길이 확인
지원 가능한 도메인 변수 길이 확인
– ∈ 비트
③ 검증대상 난수발생기 사용 확인
난수를 생성하는 경우, 검증대상 난수발생기를 사용해야 함
④ Miller-Rabin 소수 판정법 반복 횟수 확인
– 소수 판정법으로는 Miller-Rabin 소수 판정법만이 허용되며 반복 횟수는 아래와 같음
  ·  비트인 경우: 최소 56회 수행 (오류 확률: )
  ·  비트인 경우: 최소 64회 수행 (오류 확률: )
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고
□ 난수발생기를 이용한 도메인 변수 생성 방법
도메인 변수 생성 알고리즘(KCDSA_GenParam)
고려사항
입력
－ 소수 의 비트 길이 
－ 소수 의 비트 길이 
①
출력
－ 도메인 변수 , , 
1

②, ③
2

3

4
if
     단계 1로 이동
5

②, ③
6

7
if
     단계 3으로 이동
8
if
     단계 3으로 이동
③
9

②
10
mod 
11
if
     단계 9로 이동
12
도메인 변수 , ,  출력

암호모듈 구현안내서
128
① 도메인 변수 길이 확인
지원 가능한 도메인 변수 길이 확인
– ∈ 비트
② 검증대상 난수발생기 사용 확인
난수를 생성하는 경우, 검증대상 난수발생기를 사용해야 함
③ 소수 생성방법 및 Miller-Rabin 소수 판정법 반복 횟수 확인
– 소수 생성방법은 암호모듈 구현안내서(GVI Part 1) 9.1 참조
– 소수 판정법으로는 Miller-Rabin 소수 판정법만이 허용되며 반복 횟수는 아래와 같음
  ·  비트인 경우: 최소 56회 수행 (오류 확률: )
  ·  비트인 경우: 최소 64회 수행 (오류 확률: )
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

Part2: 검증대상 암호알고리즘 구현안내서
129
□ 일방향 함수 PPGF를 이용한 키 생성 방법 (다수의 서명키 동시 생성 가능)
① 도메인 변수 확인
본 구현안내서의 절차에 준하여 또는 검증필 암호모듈을 사용해 생성된 도메인 변수인 경우, 별도 확인 불필요
도메인 변수 생성 방법이 불분명한 경우, 다음의 항목을 만족하는지 확인
– ∈ 비트
– 
–   ※ ()이 로 나누어 떨어짐
– mod 
② 임의의 길이값 최대 범위
임의의정수 를생성하기위한길이변수 의최대값은시스템허용범위내에서임의의값으로선택가능
③ 검증대상 난수발생기 사용 확인
난수를 생성하는 경우, 검증대상 난수발생기를 사용해야 함
키 생성 알고리즘(KCDSA_KeyGen)
고려사항
입력
－ 도메인 변수 , , 
－ 생성할 키 개수 
－ (Optional) 사용자 입력값 
①
출력
－ 개의 (서명키, 검증키) 쌍 (, ), (, ), ... , (, )
1

②, ③
2

③
3

4
for  from  to  do
5
      
      mod 
      mod 
      mod 
      mod 
6
end for
7
for  from  to  do
8
      
mod 
      mod 
9
end for
10
개의 키 쌍 (, ), (, ), ... , (, ) 출력

암호모듈 구현안내서
130
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고
□ 난수발생기를 이용한 키 생성 방법
키 생성 알고리즘(KCDSA_KeyGen)
고려사항
입력
－ 도메인 변수 , , 
①
출력
－ (서명키, 검증키) 쌍 (, )
1

②
2
mod 
3
mod 
4
키 쌍 (, ) 출력
① 도메인 변수 확인
본 구현안내서의 절차에 준하여 또는 검증필 암호모듈을 사용해 생성된 도메인 변수인 경우, 별도 확인 불필요
도메인 변수 생성 방법이 불분명한 경우, 다음의 항목을 만족하는지 확인
– ∈ 비트
– 
–   ※ ()이 로 나누어 떨어짐
– mod 
② 검증대상 난수발생기 사용 확인
난수를 생성하는 경우, 검증대상 난수발생기를 사용해야 함
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

Part2: 검증대상 암호알고리즘 구현안내서
131
나. KCDSA 서명 생성
KCDSA 서명 생성 알고리즘(KCDSA_Sign)
고려사항
설정
－  : 내부 해시함수 (블록 길이 :  비트)
①
입력
－ 도메인 변수 , , 
－ (서명키, 검증키) 쌍 (, )
－ 메시지 
②, ③, ④
출력
－ 전자서명값 (, )
1

⑤
2
mod 
3

4
mod 
5

6
⊕mod 
7
mod 
8
if
     단계 1로 이동
9

10
전자서명값 (, ) 출력
① 검증대상 해시함수 사용 확인
사용 가능한 해시함수 확인
– 인 경우, SHA2-224 및 SHA2-256 사용 가능
– 인 경우, SHA2-256 사용 가능
② 메시지  길이 확인
메시지 은 해시함수의 입력 메시지 길이 조건을 충족해야 함
– SHA2-224, SHA2-256 : ≤ 비트
③ 도메인 변수 확인
본 구현안내서의 절차에 준하여 또는 검증필 암호모듈을 사용해 생성된 도메인 변수인 경우, 별도 확인 불필요
도메인 변수 생성 방법이 불분명한 경우, 다음의 항목을 만족하는지 확인
– ∈ 비트
– 
–   ※ ()이 로 나누어 떨어짐
– mod 

암호모듈 구현안내서
132
④ 키 쌍 확인
본 구현안내서의 절차에 준하여 또는 검증필 암호모듈을 사용해 생성된 키 쌍인 경우,
별도 확인 불필요
키 쌍 생성 방법이 불분명한 경우, 다음의 항목을 만족하는지 확인
– , 
– mod mod 
⑤ 검증대상 난수발생기 사용 확인
난수를 생성하는 경우, 검증대상 난수발생기를 사용해야 함
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

Part2: 검증대상 암호알고리즘 구현안내서
133
다. KCDSA 서명 검증
KCDSA 서명 검증 알고리즘(KCDSA_Verify)
고려사항
설정
－  : 내부 해시함수 (블록 길이 :  비트)
①
입력
－ 도메인 변수 , , 
－ 검증키 
－ 메시지 
－ 전자서명값 (, )
②, ③, ④
출력
－ 서명검증 결과  or 
1
if
      출력
2

3
if≥
      출력
4
mod 
5

6
⊕mod 
7
mod 
7

8
if
      출력

      출력
① 검증대상 해시함수 사용 확인
사용 가능한 해시함수 확인
– 인 경우, SHA2-224 및 SHA2-256 사용 가능
– 인 경우, SHA2-256 사용 가능
② 메시지  길이 확인
메시지 은 해시함수의 입력 메시지 길이 조건을 충족해야 함
– SHA2-224, SHA2-256 : ≤ 비트

암호모듈 구현안내서
134
③ 도메인 변수 확인
본 구현안내서의 절차에 준하여 또는 검증필 암호모듈을 사용해 생성된 도메인 변수인 경우, 별도 확인 불필요
도메인 변수 생성 방법이 불분명한 경우, 다음의 항목을 만족하는지 확인
– ∈ 비트
– 
–   ※ ()이 로 나누어 떨어짐
– mod 
④ 검증키 확인
본 구현안내서의 절차에 준하여 또는 검증필 암호모듈을 사용해 생성된 검증키인 경우, 별도 확인 불필요
키 쌍 생성 방법이 불분명한 경우, 최소한 다음의 항목을 만족하는지 확인
– 
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

11장 타원곡선 기반 전자서명

암호모듈 구현안내서
136
범위
q 본 문서에서는 ISO/IEC 14888-3에 기술된 타원곡선 기반 전자서명 알고리즘(ECDSA) 및 한국형 인증서 기반
타원곡선 전자서명 알고리즘(EC-KCDSA)를 구현할 경우의 고려사항을 기술한다.
적용알고리즘
구분
검증대상 타원곡선
해시함수
ECDSA/
EC-KCDSA
Prime Field
112비트 안전성
P-224
SHA2-224/256
128비트 안전성
P-256
SHA2-256
Binary Field
112비트 안전성
B-233
K-233
SHA2-224/256
128비트 안전성
B-283
K-283
SHA2-256
 
관련표준
▸[KS X ISO/IEC 14888-3] 부가형 디지털 서명 – 제3부: 이산대수 기반 메커니즘 (2021)
▸[KS X ISO/IEC 15946-1] 타원곡선에 기반한 암호 기술 – 제1부: 일반 (2024)
▸[KS X ISO/IEC 15946-5] 타원곡선에 기초한 암호기법 – 제5부: 타원곡선 생성 (2024)
▸[TTAK.KO-12.0015/R3]부가형전자서명방식표준– 제3부:타원곡선을이용한한국형인증서기반전자
서명 알고리즘 (EC-KCDSA) (2016)
▸[ISO/IEC14888-3]DigitalsignatureswithappendixPart3:Descretelogarithmbasedmechanisms
(2018)
▸[ISO/IEC 15946-1] Cryptographic techniques based on elliptic curves Part 1: General (2016)
▸[ISO/IEC 15946-5] Cryptographic techniques based on elliptic curves Part 5: Elliptic curve
generation (2022)
▸[FIPS 186-5] Digital Signature Standard (DSS) (2023)
기호
타원곡선 기반 전자서명
기 호
의 미

개의 원소를 갖는 유한체
#
타원곡선 의 위수로 무한원점 를 포함한 타원곡선 의 모든 원소의 개수

타원곡선의 무한원점으로 타원곡선 가환군에서의 항등원임

비트열 의 비트 길이
1
2
3

Part2: 검증대상 암호알고리즘 구현안내서
137
타원곡선 기반 전자서명
▸타원곡선기반전자서명은타원곡선상의이산대수문제의어려움에그안전성의기초를두고있으며,ECDSA와
EC-KCDSA가 검증대상 암호알고리즘으로 승인되어 있다.
▸ECDSA와EC-KCDSA는부가형전자서명알고리즘으로서임의의길이를갖는메시지에대한전자서명을생성
및 검증할 수 있다.
▸ECDSA와EC-KCDSA는키생성,전자서명생성,그리고전자서명검증으로구성되며,권고된도메인변수만을
허용한다.
기 호
의 미

보다 크고 보다 작은 임의의 난수값을 생성하는 함수 ( 초과 ~  미만)

비트 길이의 난수 비트열을 생성하는 함수
⌈⌉
보다 크거나 같은 정수 중에서 최소값
⌊⌋
보다 작거나 같은 정수 중에서 최대값

,  둘 중 작은 값

주어진 비트열 의 상위(왼쪽) 개 비트열

주어진 비트열 의 하위(오른쪽) 개 비트열

입력된 임의 길이의 메시지 에 대해 고정된 길이의 해시값을 출력하는 해시함수

비트열 를 양의 정수값으로 변환하는 함수

양의 정수값 을 길이의 비트열로 변환하는 함수
4

암호모듈 구현안내서
138
알고리즘 명세 및 구현 시 고려사항
가. 권고 도메인 변수 사용
■ 타원곡선 기반 전자서명에서는 권고된 도메인 변수의 사용만을 허용한다.
■ 권고 커브 형태는 다음과 같다.
권고 커브 형태

Prime 커브
(P-224/256)
≡
Binary 커브
(B-233/283)
≡
Koblitz 커브
(K-233/283)
≡, 
■ 도메인 변수는 다음과 같이 구성된다.
도메인 변수 구성요소
내용

Prime 커브: 유한체 에 대하여  (는 소수)
Binary, Koblitz 커브: 유한체 에 대하여  (은 소수)
, 
타원곡선 방정식의 계수

기저점(Base point)으로 불리는 타원곡선의 특정 점(, )

기저점 의 위수(order)

타원곡선 위수의 여인자(cofactor)로 #로 정의
■ 타원곡선 연산 시 연산효율성을 위하여 다양한 좌표계가 사용될 수 있으며, 각 좌표계에 따른 무한원점은 다음과 같이
정의된다.
  - Affine 좌표계: (0, 0), (0, 1)
  - Projective 좌표계: (0, 1, 0)
  - Jacobian 좌표계: (1, 1, 0)
  - Lopez-Dahab 좌표계: (1, 0, 0)
■ 권고 커브별 도메인 변수 참조값
  - Curve P-224                                                          (D:Decimal, H:Hexadecimal)
도메인 변수
값
 (D)
26959946667150639794667015087019630673557916260026308143510066298881
 (H)
b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4

 (H)
b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21
 (H)
bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34
 (D)
26959946667150639794667015087019625940457807714424391721682722368061
5

Part2: 검증대상 암호알고리즘 구현안내서
139
  - Curve P-256                                                         (D:Decimal, H:Hexadecimal)
도메인 변수
값
 (D)
11579208921035624876269744694940757353008614341529031419553363130886709
7853951
 (H)
5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b

 (H)
6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296
 (H)
4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5
 (D)
11579208921035624876269744694940757352999695522413576034242225906106851
2044369
  - Curve B-233                                                         (D:Decimal, H:Hexadecimal)
도메인 변수
값 (Polynomial Basis)
 (H)
066 647ede6c 332c7f8c 0923bb58 213b333b 20e9ce42 81fe115f 7d8f90ad

 (H)
0fa c9dfcbac 8313bb21 39f1bb75 5fef65bc 391f8b36 f8f8eb73 71fd558b
 (H)
100 6a08a419 03350678 e58528be bf8a0bef f867a7ca 36716f7e 01f81052
 (D)
6901746346790563787434755862277025555839812737345013555379383634485463
  - Curve B-283                                                         (D:Decimal, H:Hexadecimal)
도메인 변수
값 (Polynomial Basis)
 (H)
 27b680a c8b8596d a5a4af8a 19a0303f ca97fd76 45309fa2 a581485a f6263e31 
3b79a2f5

 (H)
 5f93925 8db7dd90 e1934f8c 70b0dfec 2eed25b8 557eac9c 80e2e198 f8cdbecd 
86b12053
 (H)
 3676854 fe24141c b98fe6d4 b20d02b4 516ff702 350eddb0 826779c8 13f0df45 
be8112f4
 (D)
77706755689029162836778476272940756265696259243769048891091965267700442
77787378692871
  - Curve K-233                                                         (D:Decimal, H:Hexadecimal)
도메인 변수
값 (Polynomial Basis)
 (D)
0

 (H)
172 32ba853a 7e731af1 29f22ff4 149563a4 19c26bf5 0a4c9d6e efad6126 
 (H)
1db 537dece8 19b7f70f 555a67c4 27a8cd9b f18aeb9b 56e0c110 56fae6a3 
 (D)
3450873173395281893717377931138512760570940988862252126328087024741343
  - Curve K-283                                                         (D:Decimal, H:Hexadecimal)
도메인 변수
값 (Polynomial Basis)
 (D)
0

 (H)
 503213f 78ca4488 3f1a3b81 62f188e5 53cd265f 23c1567a 16876913 b0c2ac24 
58492836 
 (H)
 1ccda38 0f1c9e31 8d90f95d 07e5426f e87e45c0 e8184698 e4596236 4e341161 
77dd2259 
 (D)
38853377844514581418389238136470378132848117337930613242958749975298158
29704422603873

암호모듈 구현안내서
140
나. ECDSA
□ 키 생성
키 생성 알고리즘(ECDSA_GenKey)
고려사항
입력
－ 타원곡선 도메인 변수 (, , , , , )
①
출력
－ (서명키, 검증키) 쌍 (, )
1
mod
②
2

3
키 쌍 (, ) 출력
① 도메인 변수 확인
권고 도메인 변수 여부 확인
– 타원곡선 도메인 변수(, , , , , )가 P-224/256, B-233/283, K-233/283 도메인 변수 중 하나와
일치해야 함
② 검증대상 난수발생기 사용 확인
난수를 생성하는 경우, 검증대상 난수발생기를 사용해야 함
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

Part2: 검증대상 암호알고리즘 구현안내서
141
□ ECDSA 서명 생성
ECDSA 서명 생성 알고리즘(ECDSA_Sign)
고려사항
설정
－ 타원곡선 도메인 변수 (, , , , , )
－  : 내부 해시함수 (출력 길이 :  비트)
①, ②
입력
－ 서명키 
－ 메시지 
③, ④
출력
－ 전자서명값 (, )
1

2
mod
⑤
3

4
mod 
5
if
     단계 2로 이동
6
mod 
7
if
     단계 2로 이동
8

9

10
전자서명값 (, ) 출력
① 타원곡선 도메인 변수 확인
권고 도메인 변수 여부 확인
– 타원곡선 도메인 변수(, , , , , )가 P-224/256, B-233/283, K-233/283 도메인 변수 중 하나와
일치해야 함
② 검증대상 해시함수 사용 확인
사용 가능한 해시함수 확인
– P-256, B-283, K-283인 경우, SHA2-256 사용 가능
– P-224, B-233, K-233인 경우, SHA2-224 및 SHA2-256 사용 가능
③ 서명키 확인
본 구현안내서의 절차에 준하여 또는 검증필 암호모듈을 사용해 생성된 서명키인 경우, 별도 확인 불필요
서명키 생성 방법이 불분명한 경우, 최소한 다음의 항목을 만족하는지 확인
– 

암호모듈 구현안내서
142
④ 메시지  길이 확인
메시지 은 해시함수의 입력 메시지 길이 조건을 충족해야 함
– SHA2-224, SHA2-256 : ≤ 비트
⑤ 검증대상 난수발생기 사용 확인
난수를 생성하는 경우, 검증대상 난수발생기를 사용해야 함
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

Part2: 검증대상 암호알고리즘 구현안내서
143
□ ECDSA 서명 검증
ECDSA 서명 검증 알고리즘(ECDSA_Verify)
고려사항
설정
－ 타원곡선 도메인 변수 (, , , , , )
－  : 내부 해시함수 (출력 길이 :  비트)
①, ②
입력
－ 검증키 
－ 메시지 
－ 전자서명값 (, )
③, ④
출력
－ 서명검증 결과  or 
1

2

3
if≥or ≥
      출력
4

5
mod 
6
mod 
7

8
if
      출력
9
ifmod 
      출력

      출력
① 타원곡선 도메인 변수 확인
권고 도메인 변수 여부 확인
– 타원곡선 도메인 변수(, , , , , )가 P-224/256, B-233/283, K-233/283 도메인 변수 중 하나와
일치해야 함
② 검증대상 해시함수 사용 확인
사용 가능한 해시함수 확인
– P-256, B-283, K-283인 경우, SHA2-256 사용 가능
– P-224, B-233, K-233인 경우, SHA2-224 및 SHA2-256 사용 가능

암호모듈 구현안내서
144
③ 검증키 확인
본 구현안내서의 절차에 준하여 또는 검증필 암호모듈을 사용해 생성된 검증키인 경우,
별도 확인 불필요
검증키 생성 방법이 불분명한 경우, 최소한 다음의 항목을 만족하는지 확인
– 가 무한원점 가 아닌지 확인
– 의 좌표인 와 가 0이 아닌 의 원소인지 확인
– 가 타원곡선 위의 점인지 확인
–  임을 확인
④ 메시지  길이 확인
메시지 은 해시함수의 입력 메시지 길이 조건을 충족해야 함
– SHA2-224, SHA2-256 : ≤ 비트
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

Part2: 검증대상 암호알고리즘 구현안내서
145
나. EC-KCDSA
□ 키 생성
키 생성 알고리즘(ECKCDSA_GenKey)
고려사항
입력
－ 타원곡선 도메인 변수 (, , , , , )
①
출력
－ (서명키, 검증키) 쌍 (, )
1
mod
②
2

3
키 쌍 (, ) 출력
① 도메인 변수 확인
권고 도메인 변수 여부 확인
– 타원곡선 도메인 변수(, , , , , )가 P-224/256, B-233/283, K-233/283 도메인 변수 중 하나와
일치해야 함
② 검증대상 난수발생기 사용 확인
난수를 생성하는 경우, 검증대상 난수발생기를 사용해야 함
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

암호모듈 구현안내서
146
□ EC-KCDSA 서명 생성
EC-KCDSA 서명 생성 알고리즘(ECKCDSA_Sign)
고려사항
설정
－ 타원곡선 도메인 변수 (, , , , , )
－  : 내부 해시함수 (블록 길이 :  비트, 출력 길이 :  비트)
①, ②
입력
－ (서명키, 검증키) 쌍 (, )
－ 메시지 
③, ④
출력
－ 전자서명값 (, )
1
mod
⑤
2

3
× ⌈log⌉
4

5

6

7
⊕mod 
8
mod 
9
if
     단계 1로 이동
10

11
전자서명값 (, ) 출력
① 타원곡선 도메인 변수 확인
권고 도메인 변수 여부 확인
– 타원곡선 도메인 변수(, , , , , )가 P-224/256, B-233/283, K-233/283 도메인 변수 중 하나와
일치해야 함
② 검증대상 해시함수 사용 확인
사용 가능한 해시함수 확인
– P-256, B-283, K-283인 경우, SHA2-256 사용 가능
– P-224, B-233, K-233인 경우, SHA2-224 및 SHA2-256 사용 가능

Part2: 검증대상 암호알고리즘 구현안내서
147
③ 키 쌍 확인
본 구현안내서의 절차에 준하여 또는 검증필 암호모듈을 사용해 생성된 키 쌍인 경우, 별도 확인 불필요
키 쌍 생성 방법이 불분명한 경우, 다음의 항목을 만족하는지 확인
– 
– ⌊log⌋
– 
④ 메시지  길이 확인
메시지 은 해시함수의 입력 메시지 길이 조건을 충족해야 함
– SHA2-224, SHA2-256 : ≤ 비트
⑤ 검증대상 난수발생기 사용 확인
난수를 생성하는 경우, 검증대상 난수발생기를 사용해야 함
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

암호모듈 구현안내서
148
□ EC-KCDSA 서명 검증
EC-KCDSA 서명 검증 알고리즘(ECKCDSA_Verify)
고려사항
설정
－ 타원곡선 도메인 변수 (, , , , , )
－  : 내부 해시함수 (블록 길이 :  비트, 출력 길이 :  비트)
①, ②
입력
－ 검증키 
－ 메시지 
－ 전자서명값 (, )
③, ④
출력
－ 서명검증 결과  or 
1
× ⌈log⌉
2
if
      출력
3

4
ifor ≥
      출력
5

6

7
⊕mod 
8

9
if
      출력

      출력
① 타원곡선 도메인 변수 확인
권고 도메인 변수 여부 확인
– 타원곡선 도메인 변수(, , , , , )가 P-224/256, B-233/283, K-233/283 도메인 변수 중 하나와
일치해야 함
② 검증대상 해시함수 사용 확인
사용 가능한 해시함수 확인
– P-256, B-283, K-283인 경우, SHA2-256 사용 가능
– P-224, B-233, K-233인 경우, SHA2-224 및 SHA2-256 사용 가능

Part2: 검증대상 암호알고리즘 구현안내서
149
③ 검증키 확인
본 구현안내서의 절차에 준하여 또는 검증필 암호모듈을 사용해 생성된 검증키인 경우, 별도 확인 불필요
검증키 생성 방법이 불분명한 경우, 최소한 다음의 항목을 만족하는지 확인
– 가 무한원점 가 아닌지 확인
– 의 좌표인 와 가 0이 아닌 의 원소인지 확인
– 가 타원곡선 위의 점인지 확인
–  임을 확인
④ 메시지  길이 확인
메시지 은 해시함수의 입력 메시지 길이 조건을 충족해야 함
– SHA2-224, SHA2-256 : ≤ 비트
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

GVI
Part 2
Guide for 
Vendor 
 Implementations

12장 이산대수 기반 키 설정

암호모듈 구현안내서
152
범위
q 본 문서에서는 ISO/IEC 11770-3에 기술된 비대칭 기법을 이용한 키 관리 메커니즘의 부록 D.6 이산대수 기반 키
설정(DH)을 구현할 경우의 고려사항을 기술한다.
알고리즘
도메인 변수 길이(비트)
DH
(, ) ∈ { (2048, 224), (2048, 256), (3072, 256) }
관련표준
▸[KS X ISO/IEC 11770-3] 키 관리 - 제3부: 비대칭 기법을 이용한 메커니즘 (2024)
▸[TTAK.KO-12.0001/R4] 부가형 전자 서명 방식 표준 - 제2부: 한국형 인증서 기반 전자 서명 알고리즘
(KCDSA) (2016)
▸[ISO/IEC 11770-3] Key management - Part 3: Mechanisms using asymmetric techniques (2021)
기호
이산대수 기반 키 설정
기 호
의 미

비트열 의 비트 길이

 비트 길이의 소수를 생성하는 함수

Miller-Rabin 소수 판정법을 이용하여 입력값 의 소수 여부를 판단하는 함수

보다 크고 보다 작은 임의의 난수값을 생성하는 함수 ( 초과 ~  미만)

비트 길이의 난수 비트열을 생성하는 함수

Empty String
⌊⌋
보다 작거나 같은 정수 중에서 최대값

음이 아닌 정수 의 비트 이진수 표현

길이의 연속된  비트열 (Ex. , )

길이의 연속된  비트열 (Ex. , )

주어진 비트열 의 하위(오른쪽) 개 비트열

입력된 임의 길이의 메시지 에 대해 고정된 길이의 해시값을 출력하는 해시함수

비트열 를 양의 정수값으로 변환하는 함수

양의 정수값 을 길이의 비트열로 변환하는 함수
1
2
3

Part2: 검증대상 암호알고리즘 구현안내서
153
이산대수 기반 키 설정 (Key Agreement)
▸대칭키 암호알고리즘은 공개키 암호알고리즘에 비해 빠른 속도로 암･복호화를 수행하는 장점을 갖고 있다.
하지만 송･수신자가동일한 키를사용하여 암･복호화과정을 수행하여야하므로 키를 안전하게 공유하는것이
필요하다.
▸이산대수 기반 키 설정은 공개키 암호화 방식을 이용하여 송･수신자간 비밀키를 공유하는 방식으로 이산대수
문제의 어려움에 따른 안전성에 기반한다.
▸이산대수 기반 키 설정은 도메인 변수 생성, 키 토큰 생성, 그리고 키 합의 과정으로 구성된다.
알고리즘 명세 및 구현 시 고려사항
가. 도메인 변수 생성
■ 도메인 변수 , 는 다음의 조건을 만족해야 한다.
  - : 의크기를가지는소수이며, 이소수이거나최소한 보다큰소수들의곱으로구성한다.
본 문서는  가 소수인 경우를 다룬다.
  - : 을 나누는 소수이며, 의 크기를 가진다.
■ 생성원 는 다음의 조건을 만족해야 한다.
  - :위수 인부분군의생성원이다.즉, mod (, )을만족하는정수를선택한다.
□ 일방향 함수 PPGF를 이용한 도메인 변수 생성 방법
일방향 함수(PPGF)
고려사항
설정
－  : 내부 해시함수 (출력 길이 :  비트)
①
입력
－ 비트열 
－ 출력 길이(비트) 
출력
－ 길이 인 비트열 
1
⌊⌋
2
mod 
3

4
for  from  to  do
5
      
6
end for
7

4
5

암호모듈 구현안내서
154
도메인 변수 생성 알고리즘(DH_GenParam)
고려사항
입력
－ 소수 의 비트 길이 
－ 소수 의 비트 길이 
②
출력
－ 도메인 변수 , , 
－ 증거값 , , , 
1

③
2

3
∨
4

5
if
     단계 1로 이동
④
6

7

8
if
     단계 1로 이동
9

10
∨
11

12

13
if
     단계 7로 이동
14
if
     단계 7로 이동
④
15
if
     단계 7로 이동
④
16

③
17
mod 
18
if
     단계 16으로 이동
19
도메인 변수 , , 와 증거값 , , ,  출력
① 검증대상 해시함수 사용 확인
사용 가능한 해시함수 확인
– 인 경우, SHA2-224 및 SHA2-256 사용 가능
– 인 경우, SHA2-256 사용 가능

Part2: 검증대상 암호알고리즘 구현안내서
155
② 도메인 변수 길이 확인
지원 가능한 도메인 변수 길이 확인
– ∈ 비트
③ 검증대상 난수발생기 사용 확인
난수를 생성하는 경우, 검증대상 난수발생기를 사용해야 함
④ Miller-Rabin 소수 판정법 반복 횟수 확인
– 소수 판정법으로는 Miller-Rabin 소수 판정법만이 허용되며 반복 횟수는 아래와 같음
  ·  비트인 경우: 최소 56회 수행 (오류 확률: )
  ·  비트인 경우: 최소 64회 수행 (오류 확률: )
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고
□ 난수발생기를 이용한 도메인 변수 생성 방법
도메인 변수 생성 알고리즘(KCDSA_GenParam)
고려사항
입력
－ 소수 의 비트 길이 
－ 소수 의 비트 길이 
①
출력
－ 도메인 변수 , , 
1

②, ③
2

3

4
if
     단계 1로 이동
5

②, ③
6

7
if
     단계 3으로 이동
8
if
     단계 3으로 이동
③
9

②
10
mod 
11
if
     단계 9로 이동
12
도메인 변수 , ,  출력

암호모듈 구현안내서
156
① 도메인 변수 길이 확인
지원 가능한 도메인 변수 길이 확인
– ∈ 비트
② 검증대상 난수발생기 사용 확인
난수를 생성하는 경우, 검증대상 난수발생기를 사용해야 함
③ 소수 생성방법 및 Miller-Rabin 소수 판정법 반복 횟수 확인
– 소수 생성방법은 암호모듈 구현안내서(GVI Part 1) 9.1 참조
– 소수 판정법으로는 Miller-Rabin 소수 판정법만이 허용되며 반복 횟수는 아래와 같음
  ·  비트인 경우: 최소 56회 수행 (오류 확률: )
  ·  비트인 경우: 최소 64회 수행 (오류 확률: )
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

Part2: 검증대상 암호알고리즘 구현안내서
157
나. 키 토큰 생성
■ 구성원 A는 랜덤한 비밀 값  (∈⋯)를 생성하고 키 토큰 
mod 를 계산하여 구성원 B에게
전송한다.
■ 구성원 B는 랜덤한 비밀 값  (∈⋯)를 생성하고 키 토큰 
mod 를 계산하여 구성원 A에게
전송한다.
① 도메인 변수 확인
본 구현안내서의 절차에 준하여 또는 검증필 암호모듈을 사용해 생성된 도메인 변수인 경우, 별도 확인 불필요
도메인 변수 생성 방법이 불분명한 경우, 다음의 항목을 만족하는지 확인
– ∈ 비트
– 
–   ※ ()이 로 나누어 떨어짐
– mod 
② 검증대상 난수발생기 사용 확인
난수를 생성하는 경우, 검증대상 난수발생기를 사용해야 함
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고
키 토큰 생성 알고리즘(DH_GenToken)
고려사항
입력
－ 도메인 변수 , , 
①
출력
－ 개인키(비밀값) 
－ 공개키(키 토큰) 
1

②
2
mod 
3
개인키 , 키 토큰  출력

암호모듈 구현안내서
158
다. 키 합의
■ 구성원 A는 다음과 같이 공유키를 계산한다.




mod 
■ 구성원 B는 다음과 같이 공유키를 계산한다.




mod 
① 도메인 변수 확인
본 구현안내서의 절차에 준하여 또는 검증필 암호모듈을 사용해 생성된 도메인 변수인 경우, 별도 확인 불필요
도메인 변수 생성 방법이 불분명한 경우, 다음의 항목을 만족하는지 확인
– ∈ 비트
– 
–   ※ ()이 로 나누어 떨어짐
– mod 
② 키 토큰 유효성 확인
전달받은 키 토큰 가 유효한 형태인지 확인
※ 구성원 간 인증이 선행된 경우 유효성 확인은 불필요함
※ 상대 구성원을 확인할 수 없는 경우, 키 토큰에 대한 유효성 검사 수행

[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

키 합의 알고리즘(DH_ComputeSharedSecret)
고려사항
입력
－ 도메인 변수 , , 
－ 개인키(비밀값) 
－ 상대 구성원의 키 토큰 
①
출력
－ 공유키 
1
if≥or ≤
     Error 출력
②
2
ifmod 
     Error 출력
②
3
mod 
4

5
공유키  출력

13장 타원곡선 기반 키 설정

암호모듈 구현안내서
160
범위
q 본 문서에서는 ISO/IEC 11770-3에 기술된 비대칭 기법을 이용한 키 관리 메커니즘의 부록 E.7 타원곡선 기반 키
설정(ECDH)을 구현할 경우의 고려사항을 기술한다.
 
구분
검증대상 타원곡선
112비트 안전성
128비트 안전성
Prime Field
P-224
P-256
Binary Field
B-233
B-283
K-233
K-283
q 타원곡선 기반 키 설정을 구현 시, 검증대상 키 설정에서는 다음의 여인자 곱셈 방법을 사용한다.
 
Cofactor Multiplication(#)
Compatibility()
Option 1
○
×

관련표준
▸[KS X ISO/IEC 11770-3] 키 관리 – 제3부: 비대칭 기법을 이용한 메커니즘 (2024)
▸[KS X ISO/IEC 15946-1] 타원곡선에 기반한 암호 기술 – 제1부: 일반 (2024)
▸[KS X ISO/IEC 15946-5] 타원곡선에 기초한 암호기법 – 제5부: 타원곡선 생성 (2024)
▸[ISO/IEC 11770-3] Key management Part 3: Mechanisms using asymmetric techniques (2021)
▸[ISO/IEC 15946-1] Cryptographic techniques based on elliptic curves Part 1: General (2016)
▸[ISO/IEC 15946-5] Cryptographic techniques based on elliptic curves Part 5: Elliptic curve
generation (2022)
▸[FIPS 186-5] Digital Signature Standard (DSS) (2023)
타원곡선 기반 키 설정
1
2

Part2: 검증대상 암호알고리즘 구현안내서
161
기호
기 호
의 미

개의 원소를 갖는 유한체
#
타원곡선 의 위수로 무한원점 를 포함한 타원곡선 의 모든 원소의 개수

타원곡선의 무한원점으로 타원곡선 가환군에서의 항등원임

비트열 의 비트 길이

보다 크고 보다 작은 임의의 난수값을 생성하는 함수 ( 초과 ~  미만)

비트 길이의 난수 비트열을 생성하는 함수

주어진 비트열 의 상위(왼쪽) 개 비트열

주어진 비트열 의 하위(오른쪽) 개 비트열

비트열 를 양의 정수값으로 변환하는 함수

양의 정수값 을 길이의 비트열로 변환하는 함수
타원곡선 기반 키 설정
▸대칭키 암호알고리즘은 공개키 암호알고리즘에 비해 빠른 속도로 암･복호화를 수행하는 장점을 갖고 있다.
하지만 송･수신자가동일한 키를사용하여 암･복호화과정을 수행하여야하므로 키를 안전하게 공유하는것이
필요하다.
▸타원곡선기반키설정은공개키암호화방식을이용하여송･수신자간비밀키를공유하는방식으로타원곡선상
이산대수 문제의 어려움에 따른 안전성에 기반한다.
▸타원곡선 기반 키 설정은 키 토큰 생성과 키 합의 과정으로 구성된다.
3
4

암호모듈 구현안내서
162
알고리즘 명세 및 구현 시 고려사항
가. 권고 도메인 변수 사용
■ 타원곡선 기반 전자서명에서는 권고된 도메인 변수의 사용만을 허용한다.
■ 권고 커브 형태는 다음과 같다.
권고 커브 형태

Prime 커브
(P-224/256)
≡
   (cofactor , compatibility )
Binary 커브
(B-233/283)
≡
   (cofactor , compatibility )
Koblitz 커브
(K-233/283)
≡, 
   (cofactor , compatibility )
■ 도메인 변수는 다음과 같이 구성된다.
도메인 변수 구성요소
내용

Prime 커브: 유한체 에 대하여  (는 소수)
Binary, Koblitz 커브: 유한체 에 대하여  (은 소수)
, 
타원곡선 방정식의 계수

기저점(Base point)으로 불리는 타원곡선의 특정 점(, )

기저점 의 위수(order)

타원곡선 위수의 여인자(cofactor)로 #로 정의
■ 타원곡선 연산 시 연산효율성을 위하여 다양한 좌표계가 사용될 수 있으며, 각 좌표계에 따른 무한원점은 다음과 같이
정의된다.
  - Affine 좌표계: (0, 0), (0, 1)
  - Projective 좌표계: (0, 1, 0)
  - Jacobian 좌표계: (1, 1, 0)
  - Lopez-Dahab 좌표계: (1, 0, 0)
■ 권고 커브별 도메인 변수 참조값
  - Curve P-224                                                          (D:Decimal, H:Hexadecimal)
도메인 변수
값
 (D)
26959946667150639794667015087019630673557916260026308143510066298881
 (H)
b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4

 (H)
b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21
 (H)
bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34
 (D)
26959946667150639794667015087019625940457807714424391721682722368061
5

Part2: 검증대상 암호알고리즘 구현안내서
163
  - Curve P-256                                                         (D:Decimal, H:Hexadecimal)
도메인 변수
값
 (D)
11579208921035624876269744694940757353008614341529031419553363130886709
7853951
 (H)
5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b

 (H)
6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296
 (H)
4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5
 (D)
11579208921035624876269744694940757352999695522413576034242225906106851
2044369
  - Curve B-233                                                         (D:Decimal, H:Hexadecimal)
도메인 변수
값 (Polynomial Basis)
 (H)
066 647ede6c 332c7f8c 0923bb58 213b333b 20e9ce42 81fe115f 7d8f90ad

 (H)
0fa c9dfcbac 8313bb21 39f1bb75 5fef65bc 391f8b36 f8f8eb73 71fd558b
 (H)
100 6a08a419 03350678 e58528be bf8a0bef f867a7ca 36716f7e 01f81052
 (D)
6901746346790563787434755862277025555839812737345013555379383634485463
  - Curve B-283                                                         (D:Decimal, H:Hexadecimal)
도메인 변수
값 (Polynomial Basis)
 (H)
 27b680a c8b8596d a5a4af8a 19a0303f ca97fd76 45309fa2 a581485a f6263e31 
3b79a2f5

 (H)
 5f93925 8db7dd90 e1934f8c 70b0dfec 2eed25b8 557eac9c 80e2e198 f8cdbecd 
86b12053
 (H)
 3676854 fe24141c b98fe6d4 b20d02b4 516ff702 350eddb0 826779c8 13f0df45 
be8112f4
 (D)
77706755689029162836778476272940756265696259243769048891091965267700442
77787378692871
  - Curve K-233                                                         (D:Decimal, H:Hexadecimal)
도메인 변수
값 (Polynomial Basis)
 (D)
0

 (H)
172 32ba853a 7e731af1 29f22ff4 149563a4 19c26bf5 0a4c9d6e efad6126 
 (H)
1db 537dece8 19b7f70f 555a67c4 27a8cd9b f18aeb9b 56e0c110 56fae6a3 
 (D)
3450873173395281893717377931138512760570940988862252126328087024741343
  - Curve K-283                                                         (D:Decimal, H:Hexadecimal)
도메인 변수
값 (Polynomial Basis)
 (D)
0

 (H)
 503213f 78ca4488 3f1a3b81 62f188e5 53cd265f 23c1567a 16876913 b0c2ac24 
58492836 
 (H)
 1ccda38 0f1c9e31 8d90f95d 07e5426f e87e45c0 e8184698 e4596236 4e341161 
77dd2259 
 (D)
38853377844514581418389238136470378132848117337930613242958749975298158
29704422603873

암호모듈 구현안내서
164
나. 키 토큰 생성
■ 구성원A는랜덤한비밀값 (∈⋯)를생성하고키토큰 를계산하여구성원 B에게전송한다.
■ 구성원B는랜덤한비밀값 (∈⋯)를생성하고키토큰 를계산하여구성원A에게전송한다.
① 도메인 변수 확인
권고 도메인 변수 여부 확인
– 타원곡선 도메인 변수(, , , , , )가 P-224/256, B-233/283, K-233/283 도메인 변수 중 하나와
일치해야 함
② 검증대상 난수발생기 사용 확인
난수를 생성하는 경우, 검증대상 난수발생기를 사용해야 함
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고
키 토큰 생성 알고리즘(ECDH_GenToken)
고려사항
입력
－ 타원곡선 도메인 변수 (, , , , , )
①
출력
－ 개인키(비밀값) 
－ 공개키(키 토큰) 
1

②
2

3
개인키 , 키 토큰  출력

Part2: 검증대상 암호알고리즘 구현안내서
165
다. 키 합의
■ 구성원 A는 다음과 같이 공유키를 계산한다.
∙
■ 구성원 B는 다음과 같이 공유키를 계산한다.
∙
① 도메인 변수 확인
권고 도메인 변수 여부 확인
– 타원곡선 도메인 변수(, , , , , )가 P-224/256, B-233/283, K-233/283 도메인 변수 중 하나와
일치해야 함
키 합의 알고리즘(ECDH_ComputeSharedSecret)
고려사항
입력
－ 타원곡선 도메인 변수 (, , , , , )
－ 개인키(비밀값) 
－ 상대 구성원의 키 토큰 
①
출력
－ 공유키 
1
if
     Error 출력
②
2
∙
3
if
     Error 출력
4

5
공유키  출력

암호모듈 구현안내서
166
② 키 토큰 유효성 확인
전달받은 키 토큰 가 유효한 형태인지 확인
– 가 무한원점 가 아닌지 확인
– 의 좌표인 와 가 0이 아닌 의 원소인지 확인
– 가 타원곡선 위의 점인지 확인
–  임을 확인
※ 구성원 간 인증이 선행된 경우 유효성 확인은 불필요함
※ 상대 구성원을 확인할 수 없는 경우, 키 토큰에 대한 유효성 검사 수행

[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

14장 패스워드 기반 키 유도

암호모듈 구현안내서
168
범위
q 본문서에서는TTAK.KO-12.0334에명세된패스워드기반키유도 알고리즘인PBKDF를 구현할 경우의 고려사항을
기술한다.
구분
알고리즘
의사 난수 함수
(PRF)
HMAC
SHA2-224/256/384/512
LSH-224/256/384/512
LSH-512_224/512_256
SHA3-224/256/384/512
관련표준
▸[TTAK.KO-12.0334-Part1] 패스워드 기반 키 유도 함수 – 제1부: 일반 (2018)
▸[TTAK.KO-12.0334-Part2] 패스워드 기반 키 유도 함수 – 제2부: 해시 함수 SHA-2 (2018)
▸[TTAK.KO-12.0334-Part3] 패스워드 기반 키 유도 함수 – 제3부: 해시 함수 LSH (2018)
▸[TTAK.KO-12.0334-Part4] 패스워드 기반 키 유도 함수 – 제4부: 해시 함수 SHA-3 (2019)
▸[RFC 8018] PKCS #5: Password-Based Cryptography Specification Version 2.1 (2017)
기호
기 호
의 미

비밀키 와 메시지 를 이용하여 의사 난수 비트열을 생성하는 의사 난수 함수

주어진 비트열 의 상위(왼쪽) 개 비트열
⌈⌉
보다 크거나 같은 정수 중에서 최소값

음이 아닌 정수 의 비트 이진수 표현
패스워드 기반 키 유도
1
2
3

Part2: 검증대상 암호알고리즘 구현안내서
169
패스워드 기반 키 유도
▸패스워드기반키유도 함수(PBKDF)는패스워드와부가데이터를 입력으로받아암호알고리즘동작에사용될수
있는 키 요소를 생성하는 함수이며, 키 요소가 가져야 하는 길이에 따라 의사 난수 함수를 반복 호출한다.
▸PBKDF는 기반이 되는 의사 난수 함수와 반복 횟수에 의해 정의된다.
▸PBKDF의 입력은 패스워드, 솔트, 유도되는 키의 길이 정보를 포함한다.
▸반복횟수의경우필수로요구되는값은1,000회이지만,알고리즘동작환경의허용가능한범위내에서최대한
많은 반복 횟수(100,000회 이상)를 사용할 것을 권고한다.
알고리즘 명세 및 구현 시 고려사항
4
5

암호모듈 구현안내서
170
패스워드 기반 키 유도(PBKDF)
고려사항
설정
－  : 내부 의사 난수 함수 (출력 길이 :  비트)
①
입력
－ 패스워드/패스프레이즈 
－ 솔트 
－ 반복 횟수 
－ 출력값의 비트 길이 
②, ③, ④
출력
－ 유도된 키 비트열 
1
if× 
     Error 출력
2
⌈⌉
3
× 
4
for  from  to  do
5
      
      
6
      for  from  to  do
7
            
            ⊕
8
      end for
9
end for
10

11
유도된 키 비트열  출력
① 검증대상 의사 난수 함수 사용 확인
의사 난수 함수로 검증대상 해시함수 기반 메시지 인증코드 사용 확인
– HMAC_SHA2 인 경우: SHA2-224/256/384/512
– HMAC_LSH 인 경우: LSH-224/256/384/512, LSH-512_224/512_256
– HMAC_SHA3 인 경우: SHA3-224/256/384/512
② 패스워드/패스프레이즈 길이 확인
입력된 패스워드/패스프레이즈의 길이는 최소 9자리 이상이어야 함

Part2: 검증대상 암호알고리즘 구현안내서
171
③ 솔트 길이 및 구성 방법 확인
솔트는 전체 또는 일부가 난수발생기로 생성되어야 하며, 난수발생기로 생성된 부분의 길이는 128 비트 이상
이어야 함
※ 솔트는 패드워드 사전공격(Dictionary Attack)을 방지하기 위한 목적으로 사용되는 파라미터임
④ 반복 횟수 확인
반복 횟수로 1,000 이상의 값이 입력되는지 확인
※ 알고리즘 동작환경의 허용 가능한 범위에서 최대한 많은 반복 횟수 사용(100,000회 이상) 권고
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

14장 부속서 B
암호모듈 보안정책서
GVI
Part 2
Guide for 
Vendor 
 Implementations

15장 의사난수 함수 기반 키 유도

암호모듈 구현안내서
174
범위
q 본 문서에서는 TTAK.KO-12.0272 및 TTAK.KO-12.0333에 명세된 의사난수 함수 기반 키 유도 알고리즘인
KBKDF를 구현할 경우의 고려사항을 기술한다.
구분
알고리즘
의사 난수 함수
(PRF)
CMAC
ARIA, SEED, LEA, AES, HIGHT
HMAC
SHA2-224/256/384/512
LSH-224/256/384/512
LSH-512_224/512_256
SHA3-224/256/384/512
관련표준
▸[TTAK.KO-12.0333-Part1] HMAC 기반 키 유도 함수 – 제1부: 일반 (2018)
▸[TTAK.KO-12.0333-Part2] HMAC 기반 키 유도 함수 – 제2부: 해시 함수 SHA-2 (2018)
▸[TTAK.KO-12.0333-Part3] HMAC 기반 키 유도 함수 – 제3부: 해시 함수 LSH (2018)
▸[TTAK.KO-12.0333-Part4] HMAC 기반 키 유도 함수 – 제4부: 해시 함수 SHA-3 (2019)
▸[TTAK.KO-12.0272] 블록 암호 기반 키 유도 함수 (2015)
▸[ISO/IEC 11770-6] Key management Part 6: Key derivation (2016)
의사난수 함수 기반 키 유도
1
2

Part2: 검증대상 암호알고리즘 구현안내서
175
기호
기 호
의 미

비트열 의 비트 길이

비밀키 와 메시지 를 이용하여 의사 난수 비트열을 생성하는 의사 난수 함수

Empty String

길이의 연속된  비트열 (Ex. , )

길이의 연속된  비트열 (Ex. , )
⌈⌉
보다 크거나 같은 정수 중에서 최소값

음이 아닌 정수 의 비트 이진수 표현

주어진 비트열 의 상위(왼쪽) 개 비트열

데이터 가 선택적 입력임을 표시
의사난수 함수 기반 키 유도
▸의사난수함수기반키유도함수(KBKDF)는키와부가데이터를입력으로받아암호알고리즘동작에사용될수
있는 키 요소를 생성하는 함수이며, 키 요소가 가져야 하는 길이에 따라 의사 난수 함수를 반복 호출한다.
▸의사난수함수를반복호출하는방법을반복모드라고부르며,이반복모드는카운터모드,피드백모드,더블
파이프라인 모드로 구분된다.
▸반복과정에서,입력된키는키유도키로사용되고,입력데이터는반복변수와고정된입력데이터의문자열로
구성된다.
▸반복모드에따라,반복변수는카운터나이전단계에서의의사난수함수출력,또는둘의결합이될수있으며,
더블파이프라인 반복 모드의 경우에는 첫 번째 파이프라인으로부터의 출력이 될 수 있다.
3
4

암호모듈 구현안내서
176
알고리즘 명세 및 구현 시 고려사항
가. 카운터(CTR) 모드
▸카운터 모드에서 의사 난수 함수의 출력은 카운터를 반복 변수로 사용하여 계산된다.
▸각 반복 과정에서 고정된 입력 데이터 및 반복 변수는 다음과 같다.
  - 반복 변수 : 
  - 고정된 입력 데이터 : 
5

Part2: 검증대상 암호알고리즘 구현안내서
177
카운터 모드 키 유도 함수(KBKDF_CTR )
고려사항
설정
－  : 내부 의사 난수 함수 (출력 길이 :  비트)
－  : 2진수로 표현할 카운터 값의 비트 길이
－  : 2진수로 표현할 정보의 비트 길이
①, ②
입력
－ 입력 암호키 
－ (키 목적) 레이블 
－ (키 정보) 컨텍스트 
－ 출력값의 비트 길이 
③, ④
출력
－ 유도된 키 비트열 
1
⌈⌉
2
if
     Error 출력
3

4
for  from  to  do
5
      
      
⑤
6
end for
7

8
유도된 키 비트열  출력
① 검증대상 의사 난수 함수 사용 확인
의사 난수 함수로 검증대상 메시지 인증코드 사용 확인
– CMAC-ARIA, CMAC-SEED, CMAC-LEA, CMAC-AES, CMAC-HIGHT
– HMAC-SHA2, HMAC-LSH, HMAC-SHA3
②  길이 범위 확인
지원 가능한 길이 범위 확인
– ≤≤
③ 암호키 길이 확인
의사 난수 함수별 지원 가능한 키 길이 확인
– CMAC-ARIA, CMAC-LEA, CMAC-AES의 암호키 길이: 128/192/256 비트
– CMAC-SEED, CMAC-HIGHT의 암호키 길이: 128 비트
- HMAC 기반 메시지 인증코드 암호키 길이 : ≤

암호모듈 구현안내서
178
④  길이 범위 확인
지원 가능한 길이 범위 확인
–  비트
⑤ 키 제어 이슈 관련 고려사항
로 CMAC을 사용할 경우 발생할 수 있는 키 제어 관련 보안 이슈를 고려하여, 고정 데이터를 다음과 같이
구성할 수 있음
– ,
    
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

Part2: 검증대상 암호알고리즘 구현안내서
179
나. 피드백(FB) 모드
▸피드백 모드에서 의사 난수 함수의 출력은 이전 반복의 결과와 (선택적으로) 카운터를 반복 변수로 사용하여
계산된다.
▸각 반복 과정에서 고정된 입력 데이터 및 반복 변수는 다음과 같다.
  - 반복 변수 : 
  - 고정된 입력 데이터 : 

암호모듈 구현안내서
180
피드백 모드 키 유도 함수(KBKDF_FB )
고려사항
설정
－  : 내부 의사 난수 함수 (출력 길이 :  비트)
－  : 2진수로 표현할 카운터 값의 비트 길이
－  : 2진수로 표현할 정보의 비트 길이
－  : 카운터 사용 여부
①, ②
입력
－ 입력 암호키 
－ 초기값 
－ (키 목적) 레이블 
－ (키 정보) 컨텍스트 
－ 출력값의 비트 길이 
③, ④
출력
－ 유도된 키 비트열 
1
⌈⌉
2
if
     Error 출력
3

4

⑤
5
for  from  to  do
6
     if
          
     
          
⑤
7
     
8
end for
9

10
유도된 키 비트열  출력
① 검증대상 의사 난수 함수 사용 확인
의사 난수 함수로 검증대상 메시지 인증코드 사용 확인
– CMAC-ARIA, CMAC-SEED, CMAC-LEA, CMAC-AES, CMAC-HIGHT
– HMAC-SHA2, HMAC-LSH, HMAC-SHA3
②  길이 범위 확인
지원 가능한 길이 범위 확인
– ≤≤

Part2: 검증대상 암호알고리즘 구현안내서
181
③ 암호키 길이 확인
의사 난수 함수별 지원 가능한 키 길이 확인
– CMAC-ARIA, CMAC-LEA, CMAC-AES의 암호키 길이: 128/192/256 비트
– CMAC-SEED, CMAC-HIGHT의 암호키 길이: 128 비트
- HMAC 기반 메시지 인증코드 암호키 길이 : ≤
④  길이 범위 확인
지원 가능한 길이 범위 확인
–  비트
⑤ 키 제어 이슈 관련 고려사항
로 CMAC을 사용할 경우 발생할 수 있는 키 제어 관련 보안 이슈를 고려하여, 를 입력받지 않고 다음과
같이 구성할 수 있음
– 
※ 이 경우, 를 로 설정하여 카운터 값을 반드시 사용해야 함
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

암호모듈 구현안내서
182
다. 더블 파이프라인(DP) 모드
▸더블 파이프라인 모드는 의사 난수 함수를 두 개의 파이프라인에서 반복하도록 정의한다. 첫 번째 파이프라인에서
비트열 가 생성되고, 의 각 블록은 두 번째 파이프라인에서 해당하는 의사 난수 함수의 입력값으로 사용된다.
▸각 반복 과정에서 고정된 입력 데이터와 초기값, 반복 변수는 다음과 같다.
  - 초기값  : 
  - 반복 변수 : 
  - 고정된 입력 데이터 : 

Part2: 검증대상 암호알고리즘 구현안내서
183
더블 파이프라인 모드 키 유도 함수(KBKDF_DP )
고려사항
설정
－  : 내부 의사 난수 함수 (출력 길이 :  비트)
－  : 2진수로 표현할 카운터 값의 비트 길이
－  : 2진수로 표현할 정보의 비트 길이
－  : 카운터 사용 여부
①, ②
입력
－ 입력 암호키 
－ (키 목적) 레이블 
－ (키 정보) 컨텍스트 
－ 출력값의 비트 길이 
③, ④
출력
－ 유도된 키 비트열 
1
⌈⌉
2
if
     Error 출력
3

4

5
for  from  to  do
6
     
7
     if
          
     
          
⑤
8
      
9
end for
10

11
유도된 키 비트열  출력
① 검증대상 의사 난수 함수 사용 확인
의사 난수 함수로 검증대상 메시지 인증코드 사용 확인
– CMAC-ARIA, CMAC-SEED, CMAC-LEA, CMAC-AES, CMAC-HIGHT
– HMAC-SHA2, HMAC-LSH, HMAC-SHA3
②  길이 범위 확인
지원 가능한 길이 범위 확인
– ≤≤

암호모듈 구현안내서
184
③ 암호키 길이 확인
의사 난수 함수별 지원 가능한 키 길이 확인
– CMAC-ARIA, CMAC-LEA, CMAC-AES의 암호키 길이: 128/192/256 비트
– CMAC-SEED, CMAC-HIGHT의 암호키 길이: 128 비트
- HMAC 기반 메시지 인증코드 암호키 길이 : ≤
④  길이 범위 확인
지원 가능한 길이 범위 확인
–  비트
⑤ 키 제어 이슈 관련 고려사항
로 CMAC을 사용할 경우 발생할 수 있는 키 제어 관련 보안 이슈를 고려하여, 다음과 같이 구성할 수 있음
– 를 로 설정하여 카운터 값을 반드시 사용함
[공통] 제로화 수행
사용이 끝난 중요보안매개변수(SSP)에 대한 제로화 수행
※ [부록] “안전한 제로화” 참고

부록

암호모듈 구현안내서
186
안전한 제로화
가. 최적화로 인한 생략방지
□ 컴파일러 최적화 옵션으로 인한 제로화 코드 생략방지
－ 제로화 코드는 사용된 메모리의 값을 초기화한 후 메모리 자원을 반납하는 절차이기 때문에 컴파일러 최적화 옵션에
따라 생략되는 경우가 존재함
－ 제로화 코드가 컴파일러 옵션에 의해 생략되는 것을 방지하기 위하여 다음의 방법 사용 가능
대응방법
내용
Fake 코드이용
제로화를 수행하는 API에 연산의 결과에 영향을 주지 않고 추가 연산만을 수행하는 코드를 삽입하여
컴파일러 최적화로 인한 코드 생략 방지
Volatile 키워드 사용
volatile은 컴파일러 옵션 최적화의 영향을 받지 않도록 하는 키워드이기 때문에 변수 선언 또는 제로화 API
구현 시 volatile 키워드 적용
SecureZeroMemory
윈도우 환경에서는 SecureZeroMemory API를 제공하여 코드생략 방지
(내부적으로 volatile 키워드를 이용하고 있음)
나. 컨텍스트 제로화
□ 컨텍스트 포인터 제로화 시 다중 제로화 필요
－ 암호관련API수행시필요한인자를컨텍스트형태로전달하는경우가있으며컨텍스트에는다음과같이포인터변수들이
포함되기도 함
컨텍스트 정의
typedef struct _KCMVP_BIGNUM_{
    int sign;                    // 부호
    unsigned int numOfLimb;    // 큰수 저장에 사용된 워드 개수
    unsigned int* limb;        // 큰수를 저장한 메모리 포인터
}KCMVP_BIGNUM
typedef struct _KCMVP_RSA_PrivateKey_{
    KCMVP_BIGNUM  *n;
         // 모듈러스 값
    KCMVP_BIGNUM  *d;
         // 개인키 d값
    KCMVP_BIGNUM  *p;
         // 개인키 p값
    KCMVP_BIGNUM  *q;
         // 개인키 q값
} KCMVP_RSA_PrivateKey;
부 록
1

Part2: 검증대상 암호알고리즘 구현안내서
187
－ 다음은 컨텍스트 내부에 포함된 포인터 변수들이 참조하는 메모리 제로화를 누락한 경우임
잘못된 제로화
BOOL KCMVP_RSA_PrivateKey_Zeroize(KCMVP_RSA_PrivateKey* privKey){
    if(priv Key != NULL) {
        SecureZeroMemory(privKey, sizeof(KCMVP_RSA_PrivateKey));
        free(privKey);
    }
    ...
}
－ 다음은 컨텍스트에 포함된 포인터 변수들이 참조하는 메모리들을 확인하여 올바르게 제로화하고 있는 경우임
올바른 제로화
BOOL KCMVP_RSA_PrivateKey_Zeroize(KCMVP_RSA_PrivateKey* privKey){
    if(priv Key != NULL){
        if(privKey->n != NULL){
            KCMVP_BIGNUM_zeroize(privKey->n);
            free(privKey->n);
        }
        if(privKey->d != NULL){
            KCMVP_BIGNUM_zeroize(privKey->d);
            free(privKey->d);
        }
        if(privKey->p != NULL){
            KCMVP_BIGNUM_zeroize(privKey->p);
            free(privKey->p);
        }
        if(privKey->q != NULL){
            KCMVP_BIGNUM_zeroize(privKey->q);
            free(privKey->q);
        }
    }
    ...
}
BOOL KCMVP_BIGNUM_zeroize(KCMVP_BIGNUM* bNum){
    ...
    if(bNum→limb != NULL){
        SecureZeroMemory(bNum→limb, WORDS_FOR_2048);
        free(bNum→limb);
    }
    ...
}

암호모듈 구현안내서
188
다. 제로화 종류
□ 절차적 제로화
－ 하나의 API 내부에서 사용이 끝난 중요보안매개변수를 제로화
※ 평문의 마지막 블록에 대한 암호화를 수행하는 Encrypt_Final()에서 암호화에 사용된 라운드키 제로화
－ API 외부에서 API 내부로 복사되어 사용된 데이터에 대한 제로화
－ API 내부에서 생성되어 사용된 데이터를 API 반환 전 제로화
절차적 제로화 예시-난수발생기 인스턴스 생성 후
int KCMVP_drbg_instantiate(DRBG_CTX *dctx, const unsigned char *pers, size_t perslen){
    // entropy : 엔트로피를 수집하는 내부 변수
    size_t entlen = 0;
    unsigned char *entropy = NULL;
     ...
    // 사용이 끝난 엔트로피를 수집하는 내부 변수를 제로화함
    KCMVP_cleanup_entropy(dctx, entropy, entlen);
    ...
}
절차적 제로화 예시-대칭키 암호화 수행 후
// 대칭키 암호화 API
int Encrypt_Final(unsinged char* CT, int* sizeofCT, unsigned char* PT, int sizeofPT, 
                    unsigned char* MK, int sizeofMK){
    int ret = TRUE;
    unsigned char RoundKeys[numofRounds][sizeofKey] = {{0x00, }, };
    
    // 라운드키 생성(키스케쥴)
    keySchedule(RoundKeys, MK, sizeofMK);
    
    // 암호화 수행(내부 암호화 API인 _Encrypt() 사용)
    ret = _Encrypt(RoundKeys, CT, sizeofCT, PT, sizeofPT);
    // 라운드 키에 대한 제로화(절차적 제로화)
    SecureZeroMemory(RoundKeys, sizeof(RoundKeys));
    return ret;
}

Part2: 검증대상 암호알고리즘 구현안내서
189
□ 운영적 제로화
－ 명시적 제로화 API를 호출함으로써, 메모리에 로드된 중요보안매개변수를 제로화
－ Task 단위의 제로화(예: 파일 암호화 완료 후, 마스터키 제로화)
－ 암호모듈 종료 시, 제로화 API를 이용하여 중요보안매개변수 제로화
운영적 제로화 예시-암호모듈 종료 시 난수발생기 내부상태 제로화
// 암호모듈 종료 API
int KCMVP_Module_Exit(KCMVP_Module_State* state){
    int ret = TRUE;
    // 난수발생기 상태 제로화
    if(state->DRBG_State != NULL)
    {
        // 난수발생기 제로화 API를 통한 제로화 수행
        ret = DRBG_zeroization(state->DRBG_State);
    }
    // 추가적으로 암호모듈 내부에 할당된 핵심보안매개변수에 대하여 운영적 제로화 수행
    
    return ret;
}
운영적 제로화 예시-Task 종료 시 제로화
// 암호모듈은 동적으로 링크되었다고 가정함
int fileEncrypt(char* originalFileName, char* encryptedFileName)
{
    int ret = TRUE;
    unsigned char MK[sizeofKey] = {0x00, };
    unsigned char PT[blockSize] = {0x00, }, CT[blockSize] = {0x00, };
    FILE* fpInput = NULL, fpOutput = NULL;
    // 암호화할 파일 열기
    fpInput = fopen(originalFileName, "r");
    if(fpInput == NULL) {ret = FALSE; goto err;}
    // 암호화된 결과를 저장할 파일 열기
    fpOutput = fopen(encryptedFileName, "w");
    if(fpOutput == NULL) {ret = FALSE; goto err;}
    // 난수발생기를 이용하여 암호화용 마스터키 생성
    DRBG_generateKey(MK, sizeofKey); 
    // 파일을 읽으며 암호화를 수행
    // 암호화된 데이터는 encryptedFileName에 저장됨
    while(!feof(originalFileName))
    {
        ...;
    }
    // 파일 암호화 Task가 완료된 후, 제로화 수행
    symmetricKey_Zeroization(MK, sizeofKey);
err:
    return ret;
}

암호모듈 구현안내서
190
안전한 패딩 방법
ECB,CBC모드는평문블록을암/복호화알고리즘의입력으로사용하기때문에,평문블록의길이가블록암호알고리
즘의 1블록 길이(blocksize)의 양의 정수배가 되도록 덧붙이기 방법이 적용되어야 한다.
본덧붙이기방법은ISO/IEC국제표준및PKCS에서사용되는방법으로,적용되는시스템에맞는방법을선택하여사용함을
권고한다. 패딩 방법의 사용 예는 16진법 바이트 단위로 표기한다.
가. 패딩 방법
□ 패딩 방법 1
－ 평문의 길이가 (blocksize × t + m) 비트 (0 ≤ m < blocksize, 0 ≤ t)일 때, m이 0이 아닐 경우, 평문의 길이가
blocksize비트의양의정수배가되도록평문의끝에비트‘1’을추가한후(blocksize– m-1)개의‘0’비트를덧붙
인다.또한m이0인경우에는패딩방법이사용됨을표기하기위해,추가적인blocksize비트‘10…00’블록을추가
한다.
예)
평문      ( 48 비트) :
4F 52 49 54 48 4D
적용 결과 (128 비트) :
4F 52 49 54 48 4D 80 00 00 00 00 00 00 00 00 00
평문      (128 비트) :
53 45 45 44 41 4C 47 A8 3E D1 80 F1 29 DC 4A 78
적용 결과 (256 비트) :
53 45 45 44 41 4C 47 A8 3E D1 80 F1 29 DC 4A 78
80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
□ 패딩 방법 2
－ 본 패딩 방법은 바이트 단위로만 적용 가능하다. 평문의 길이가 (blocksize × t + m) 바이트 (0 ≤ m < blocksize,
0 ≤ t)일 때, m이 0이 아닐 경우, 평문의 길이가 blocksize 바이트의 양의 정수배가 되도록 평문의 끝에 패딩이
필요한 바이트 수 (blocksize - m)을 덧붙인다. m이 0인 경우에는 패딩 방법이 사용됨을 표기하기 위해, 추가적인
blocksize 바이트 블록을 추가한다.
예)
평문      ( 48 비트) :
4F 52 49 54 48 4D
적용 결과 (128 비트) :
4F 52 49 54 48 4D 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A
평문      (128 비트) :
53 45 45 44 41 4C 47 A8 3E D1 AF 07 4A 73 12 2C
적용 결과 (256 비트) :
53 45 45 44 41 4C 47 A8 3E D1 AF 07 4A 73 12 2C
10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10
2

Part2: 검증대상 암호알고리즘 구현안내서
191
나. 안전성 고려사항
－ 상기패딩방법이외에도여러가지패딩방법이다양한표준및암호응용프로토콜규격에 제시되어 있다. 그러나
CBC 모드를 사용하는 다양한 암호 응용 프로토콜에 대한 패딩 오라클 공격(Padding Oracle Attack) 결과, 현재
알려진대다수의패딩방법이 공격에활용될수있는것으로밝혀진바있다2).패딩오라클공격은공격자가CBC
모드로 암호화된 데이터로부터 패딩이 올바르게 적용되었는지 여부를 확인할 수 있다는 가정에 기반하며, 이를
활용하여 암호키 없이 평문 데이터를 알 수 있다. 따라서 데이터 암호화를 위해 CBC 모드를 사용할 경우, 패딩
오라클 공격의 여지를 없애도록 구현하는 것이 필요하다. 또한 암호문에 대한 MAC 계산을 추가하여 공격자의
유효한 암호문 생성을 방지해야 한다.
2)SergeVaudenay.SecurityflawsinducedbyCBCpadding－ApplicationstoSSL,IPSEC,WTLS...AdvancesinCryptology－EUROCRYPT2002.
LectureNotesinComputerScience,vol.2332,pp.534-546,2002

GVI
Part 2
Guide for 
Vendor 
 Implementations

암호모듈 구현안내서
Part 2 검증대상 암호알고리즘 구현안내서
GVI 2025. 10.
