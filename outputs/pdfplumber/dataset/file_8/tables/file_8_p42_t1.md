| KISA_Crypto_initialize() _Preself_test() _Interity_test(){ 무결성 검증 과정 1. 서명검증키 K 복원 2. 모듈파트 M과 무결성 검증값 T를 2개의 버퍼에 각각 로드 3. T’ = HMAC(K, M) 계산 4. T’과 T값 비교 5. 중간데이터 제로화 6. 검증 결과 반환 } [HMAC·기반의·암호모듈·무결성·검증·과정] |
| --- |
| 작성 예시 2 |
| KISACrypto·V1.0·암호모듈은·자체적으로·RSA-PSS(2048-bit)를·이용하여·암호모듈에·포함한·소프트웨어·구성· 요소에·대한·무결성·검증을·수행한다.·RSA-PSS·2048-bit를·이용하여·무결성·검증을·위한·암호모듈의·서명값을· 생성한다.·전자서명·알고리즘의·특징으로·암호모듈의·무결성·검증값을·생성할·때는·서명키·S가·사용되고,·암호· 모듈의·검증을·위해서는·서명검증키·V가·사용된다.·따라서·암호모듈은·서명검증키·V를·암호모듈·내부에·저장한다· (실제로는·V키뿐·아니라·RSA-PSS·연산을·수행하기·위한·모듈러스·값도·저장된다).·서명검증키·V로부터·서명키· S를·도출하는·것은·불가능하기·때문에·서명검증키·V는·분산·저장될·필요·없다.·아래·그림은·암호모듈의·무결성· 검증값을·생성하는·자체·소프트웨어(IntegrityGenSoftware.exe)를·이용하여·256바이트·무결성·검증값을·생성하여· 암호모듈의·끝에·연접하여·최종·암호모듈을·생성한다.·즉·IntegrityGenSoftware.exe는·RSA-PSS·2048-bit· 알고리즘을·내부에·구현하고·있으며,·빌드가·완료된·모듈파트·M을·바이너리·파일로·읽어서·서명·생성키·S를·이용하여· 무결성·검증값·T를·생성한다.·생성된·T를·기존·모듈파트·M의·끝에·연접하여·저장함으로써·최종·모듈을·생성한다.· 따라서,·최종·빌드되어·배포되는·KISACrypto·V1.0은·모듈파트·M과·무결성·검증값·T가·합쳐져·있는·형태이다. 암호모듈의·무결성·검증값을·생성하는·자체·소프트웨어는·서명키·S를·내장하고·있기·때문에·형상관리·시스템을· 통하여·관리되며·인가된·사용자만·접근할·수·있다. KISACrypto V1.0 IntegrityGenSoftware.exe 모듈파트 M 서명키 S 입력 무결성 검증키 (RSA-PSS 검증키 V) 무결성 256바이트 무결성 검증값 출력 검증값 T (T = Sign(S, M)) [RSA-PSS를·이용한·무결성·검증값·생성·및·최종·암호모듈·생성·과정] |