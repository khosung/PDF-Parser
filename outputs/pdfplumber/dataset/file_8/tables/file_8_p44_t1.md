| 항목 | AS05.06 |
| --- | --- |
| 보안요구사항 개요 | 무결성·시험·실패·시·암호모듈은·오류·상태로·전환되어야·함. |
| VE05.06.01 | 암호모듈에·적용된·소프트웨어/펌웨어·무결성·시험에·대한·명세 |
| 작성 예시 |  |
| KISACrypto·V1.0·암호모듈은·RSA-PSS·2048-bit·전자서명을·이용하여·소프트웨어·구성요소에·대한·무결성· 검증을·수행한다.·초기화·과정에서·수행되는·동작·전·자가시험·중에·무결성·검증이·수행되며,·실패할·경우· 암호모듈은·심각한·오류·상태로·자동천이된다.·심각한·오류·상태에서는·암호모듈의·서비스를·사용할·수·없으며,· 재시작·또는·재설치를·통해·오류를·해결해야·한다.· 아래는·무결성·시험을·수행하는·_Integrity_test()·함수의·수도코드이다.·무결성·검증을·수행하는·아래·코드는· KISA_integrity.c·파일에·구현되어·있다.·암호모듈의·인스턴스로부터·암호모듈의·실행파일이·저장된·경로를· 얻는·API를·호출하여·경로를·얻는다(A.1·과정).·획득한·경로를·이용하여·암호모듈의·모듈·파트와·무결성·검증값· 파트를·각각·module_buf와·sig_buf·메모리에·로드한다(A.2·과정).·module_buf와·sig_buf를·이용하여· _LibraryVerify()에서는·무결성·검증을·수행한다(A.3·과정).·이·때·암호모듈에·저장되어·있는·검증키를· 로드해야·한다(B.1·과정).·검증키를·이용하여·모듈파트와·서명에·대해·무결성·검증을·수행한다(B.2·과정).· 검증이·완료된·후에는·임시적으로·생성된·데이터에·대해·제로화를·수행한다(A.5,·B.3·과정).·무결성·검증이· 실패할·경우·오류코드를·반환하여·암호모듈이·심각한·오류·상태로·천이될·수·있도록·한다(A.4·과정). int·_Integrity_test(void)·{ // A.1 라이브러리 경로 얻기 ··_GetModuleFileName(modulename,·MODULE_NAME_LEN); // A.2 버퍼에 암호모듈 파일 내용 로드 ··_Load_library(module_buf,·sig_buf,·modulename); // A.3 무결성 검증을 위한 내부 함수 호출 ··rv·=··_LibraryVerify(sig_buf,·SIGN_LEN,·module_buf,·len); ··if·(rv·!=·0)·{·// A.4 실패 시 오류코드를 반환하여 암호모듈을 심각한 오류 상태로 천이 ····rv·=·-1; ····goto·end; ··}· // A.5 제로화 Crypto_Zeroize(modulename,·MODULE_NAME_LEN); ···… } int·_LibraryVerify(const·u8·*signature,·const·u32·signatureLength,·const·u8·*message,·const·u32· messageLength)·{ ··... // B.1 모듈 내부에 저장된 공개키 로드 ··rv·=·PublicKey_Decode(pubKey,·empty_o,·sizeof(empty_o)); ··if·(rv·!=·0)·{ ····goto·error; ··} |  |