| 작성 예시 1 |
| --- |
| KISACrypto·V1.0·암호모듈은·자체적으로·HMAC-SHA256을·이용하여·암호모듈에·포함한·소프트웨어· 구성요소에·대한·무결성·검증을·수행한다.·HMAC-SHA256·알고리즘에·사용되는·무결성·검증키·K의· 크기는·256비트이며,·암호모듈의·무결성·검증을·위해·암호모듈·내부에·저장되어야·한다.·이·때·HMAC· 알고리즘의·특성상·암호모듈에·분산·저장된다.·분산·저장함으로써·단순한·메모리·덤프를·통해·암호모듈의· 무결성·검증키·값이·쉽게·노출되는·것을·방지한다.·아래·그림은·암호모듈의·무결성·검증값을·생성하는·자체· 소프트웨어(IntegrityGenSoftware.exe)를·이용하여·32바이트·무결성·검증값을·생성하여·암호모듈의·끝에· 연접하여·최종·암호모듈을·생성한다.·즉·IntegrityGenSoftware.exe는·HMAC-SHA256·알고리즘을·내부에· 구현하고·있으며,·빌드가·완료된·모듈파트·M을·바이너리·파일로·읽어서·무결성·검증키·K를·이용하여·무결성· 검증값·T를·생성한다.·생성된·T를·기존·모듈파트·M의·끝에·연접하여·저장함으로써·최종·모듈을·생성한다.· 따라서·최종·빌드되어·배포되는·KISACrypto·V1.0은·모듈파트·M과·무결성·검증값·T가·합쳐져·있는·형태이다.·· 암호모듈의·무결성·검증값을·생성하는·자체·소프트웨어는·무결성·검증키·K를·내장하고·있기·때문에·형상관리· 시스템을·통하여·관리되며·인가된·사용자만·접근할·수·있다. KISACrypto V1.0 IntegrityGenSoftware.exe 무결성 검증키 모듈파트 M (HMAC 키 K) 입력 무결성 검증키 (HMAC 키 K) 무결성 32바이트 무결성 검증값 출력 검증값 T (T = HMAC(K, M)) [HMAC을·이용한·무결성·검증값·생성·및·최종·암호모듈·생성·과정] 다음·그림은·암호모듈이·초기화될·때·자동으로·수행되는·동작·전·자가시험·내부에서·무결성·시험이·수행되는· 절차를·나타낸다.·동작·전·자가시험을·수행하는·내부함수·_Preself_test()가·호출되면·해당·함수·안에서· HMAC에·대한·암호알고리즘·KAT·시험이·선행된·후,·무결성·시험이·_Integrity_test()·함수를·통해·수행된다.· _Integrity_test()에서는·먼저·분산되어·암호모듈에·저장된·무결성·검증키·K를·복원한다.·다음으로·암호모듈· 인스턴스로부터·암호모듈의·원본·파일을·바이너리·형태로·읽어서·모듈파트·M과·무결성·검증값·T를·각각·독립된· 버퍼에·저장한다.·정상동작·확인이·완료된·HMAC-SHA256을·이용하여·M과·K를·입력으로·T’를·계산한다.· T’과·T를·비교하여·암호모듈의·무결성이·보존되었는지를·확인한다.·무결성·검증·과정에서·생성된·중간·데이터를· 모두·제로화한·후·검증결과를·반환한다.·여기에서·생성된·중간·데이터는·무결성·검증키,·무결성·검증값·등이· 복사된·버퍼를·뜻한다. |